(window.dataViewFieldEditor_bundle_jsonpfunction=window.dataViewFieldEditor_bundle_jsonpfunction||[]).push([[1],{53:function(e,t,i){"use strict";var r,n=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},o=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),a=[];function l(e){for(var t=-1,i=0;i<a.length;i++)if(a[i].identifier===e){t=i;break}return t}function s(e,t){for(var i={},r=[],n=0;n<e.length;n++){var o=e[n],s=t.base?o[0]+t.base:o[0],d=i[s]||0,u="".concat(s," ").concat(d);i[s]=d+1;var c=l(u),f={css:o[1],media:o[2],sourceMap:o[3]};-1!==c?(a[c].references++,a[c].updater(f)):a.push({identifier:u,updater:v(f,t),references:1}),r.push(u)}return r}function d(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var n=i.nc;n&&(r.nonce=n)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var a=o(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var u,c=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function f(e,t,i,r){var n=i?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=c(t,n);else{var o=document.createTextNode(n),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function m(e,t,i){var r=i.css,n=i.media,o=i.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var p=null,b=0;function v(e,t){var i,r,n;if(t.singleton){var o=b++;i=p||(p=d(t)),r=f.bind(null,i,o,!1),n=f.bind(null,i,o,!0)}else i=d(t),r=m.bind(null,i,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else n()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=n());var i=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<i.length;r++){var n=l(i[r]);a[n].references--}for(var o=s(e,t),d=0;d<i.length;d++){var u=l(i[d]);0===a[u].references&&(a[u].updater(),a.splice(u,1))}i=o}}}},54:function(e,t,i){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i=e[1]||"",r=e[3];if(!r)return i;if(t&&"function"==typeof btoa){var n=(a=r,l=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(l),"/*# ".concat(s," */")),o=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[i].concat(o).concat([n]).join("\n")}var a,l,s;return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i,r){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(r)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(n[a]=!0)}for(var l=0;l<e.length;l++){var s=[].concat(e[l]);r&&n[s[0]]||(i&&(s[2]?s[2]="".concat(i," and ").concat(s[2]):s[2]=i),t.push(s))}},t}},61:function(e,t,i){e.exports=i(17)(3)},63:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(64);case"v8light":return i(66)}},64:function(e,t,i){var r=i(53),n=i(65);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var o={insert:"head",singleton:!1};r(n,o);e.exports=n.locals||{}},65:function(e,t,i){(t=i(54)(!1)).push([e.i,".fieldEditor__flyoutPanels{height:100%}.fieldEditor__flyoutPanels__column{height:100%;overflow:hidden}.fieldEditor__flyoutPanel{height:100%;overflow-y:auto;padding:24px}.fieldEditor__flyoutPanel--pageBackground{background-color:#141519}.fieldEditor__flyoutPanel--emptyShade{background-color:#1D1E24}.fieldEditor__flyoutPanel--leftBorder{border-left:1px solid #343741}.fieldEditor__flyoutPanel--rightBorder{border-right:1px solid #343741}.fieldEditor__flyoutPanel--withContent{padding:0;overflow-y:hidden;display:flex;flex-direction:column}.fieldEditor__flyoutPanel__header{padding:0 !important;overflow-wrap:break-word !important;word-wrap:break-word !important;word-break:break-word}.fieldEditor__flyoutPanel__content{flex:1;overflow-y:auto;overflow-x:hidden;padding:24px}.fieldEditor__flyoutPanel__footer{flex:0}\n",""]),e.exports=t},66:function(e,t,i){var r=i(53),n=i(67);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var o={insert:"head",singleton:!1};r(n,o);e.exports=n.locals||{}},67:function(e,t,i){(t=i(54)(!1)).push([e.i,".fieldEditor__flyoutPanels{height:100%}.fieldEditor__flyoutPanels__column{height:100%;overflow:hidden}.fieldEditor__flyoutPanel{height:100%;overflow-y:auto;padding:24px}.fieldEditor__flyoutPanel--pageBackground{background-color:#fafbfd}.fieldEditor__flyoutPanel--emptyShade{background-color:#fff}.fieldEditor__flyoutPanel--leftBorder{border-left:1px solid #D3DAE6}.fieldEditor__flyoutPanel--rightBorder{border-right:1px solid #D3DAE6}.fieldEditor__flyoutPanel--withContent{padding:0;overflow-y:hidden;display:flex;flex-direction:column}.fieldEditor__flyoutPanel__header{padding:0 !important;overflow-wrap:break-word !important;word-wrap:break-word !important;word-break:break-word}.fieldEditor__flyoutPanel__content{flex:1;overflow-y:auto;overflow-x:hidden;padding:24px}.fieldEditor__flyoutPanel__footer{flex:0}\n",""]),e.exports=t},68:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(49),n=i(1),o=r.__importDefault(i(69));t.default=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=[]);var r=o.default(e,t),a=r[0],l=r[1],s=r[2];return n.useEffect(s,i),[a,l]}},69:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(1);t.default=function(e,t){void 0===t&&(t=0);var i=r.useRef(!1),n=r.useRef(),o=r.useRef(e),a=r.useCallback((function(){return i.current}),[]),l=r.useCallback((function(){i.current=!1,n.current&&clearTimeout(n.current),n.current=setTimeout((function(){i.current=!0,o.current()}),t)}),[t]),s=r.useCallback((function(){i.current=null,n.current&&clearTimeout(n.current)}),[]);return r.useEffect((function(){o.current=e}),[e]),r.useEffect((function(){return l(),s}),[t]),[a,s,l]}},70:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),n=i(71),o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};var a,l,s,d=function(){return(d=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};!function(e){e.AUTO="auto",e.START="start",e.CENTER="center",e.END="end"}(a||(a={})),(l=t.ScrollDirection||(t.ScrollDirection={})).HORIZONTAL="horizontal",l.VERTICAL="vertical",function(e){e.OBSERVED="observed",e.REQUESTED="requested"}(s||(s={}));var u,c,f,m,p,b=((u={})[t.ScrollDirection.VERTICAL]="scrollTop",u[t.ScrollDirection.HORIZONTAL]="scrollLeft",u),v=((c={})[t.ScrollDirection.VERTICAL]="height",c[t.ScrollDirection.HORIZONTAL]="width",c),j=((f={})[t.ScrollDirection.VERTICAL]="top",f[t.ScrollDirection.HORIZONTAL]="left",f),x=((m={})[t.ScrollDirection.VERTICAL]="marginTop",m[t.ScrollDirection.HORIZONTAL]="marginLeft",m),h=((p={})[t.ScrollDirection.VERTICAL]="marginBottom",p[t.ScrollDirection.HORIZONTAL]="marginRight",p),g=function(){function e(e){var t=e.itemCount,i=e.itemSizeGetter,r=e.estimatedItemSize;this.itemSizeGetter=i,this.itemCount=t,this.estimatedItemSize=r,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1}return e.prototype.updateConfig=function(e){var t=e.itemCount,i=e.itemSizeGetter,r=e.estimatedItemSize;null!=t&&(this.itemCount=t),null!=r&&(this.estimatedItemSize=r),null!=i&&(this.itemSizeGetter=i)},e.prototype.getLastMeasuredIndex=function(){return this.lastMeasuredIndex},e.prototype.getSizeAndPositionForIndex=function(e){if(e<0||e>=this.itemCount)throw Error("Requested index "+e+" is outside of range 0.."+this.itemCount);if(e>this.lastMeasuredIndex){for(var t=this.getSizeAndPositionOfLastMeasuredItem(),i=t.offset+t.size,r=this.lastMeasuredIndex+1;r<=e;r++){var n=this.itemSizeGetter(r);if(null==n||isNaN(n))throw Error("Invalid size returned for index "+r+" of value "+n);this.itemSizeAndPositionData[r]={offset:i,size:n},i+=n}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]},e.prototype.getSizeAndPositionOfLastMeasuredItem=function(){return this.lastMeasuredIndex>=0?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}},e.prototype.getTotalSize=function(){var e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.itemCount-this.lastMeasuredIndex-1)*this.estimatedItemSize},e.prototype.getUpdatedOffsetForIndex=function(e){var t=e.align,i=void 0===t?a.START:t,r=e.containerSize,n=e.currentOffset,o=e.targetIndex;if(r<=0)return 0;var l,s=this.getSizeAndPositionForIndex(o),d=s.offset,u=d-r+s.size;switch(i){case a.END:l=u;break;case a.CENTER:l=d-(r-s.size)/2;break;case a.START:l=d;break;default:l=Math.max(u,Math.min(d,n))}var c=this.getTotalSize();return Math.max(0,Math.min(c-r,l))},e.prototype.getVisibleRange=function(e){var t=e.containerSize,i=e.offset,r=e.overscanCount;if(0===this.getTotalSize())return{};var n=i+t,o=this.findNearestItem(i);if(void 0===o)throw Error("Invalid offset "+i+" specified");var a=this.getSizeAndPositionForIndex(o);i=a.offset+a.size;for(var l=o;i<n&&l<this.itemCount-1;)l++,i+=this.getSizeAndPositionForIndex(l).size;return r&&(o=Math.max(0,o-r),l=Math.min(l+r,this.itemCount-1)),{start:o,stop:l}},e.prototype.resetItem=function(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)},e.prototype.findNearestItem=function(e){if(isNaN(e))throw Error("Invalid offset "+e+" specified");e=Math.max(0,e);var t=this.getSizeAndPositionOfLastMeasuredItem(),i=Math.max(0,this.lastMeasuredIndex);return t.offset>=e?this.binarySearch({high:i,low:0,offset:e}):this.exponentialSearch({index:i,offset:e})},e.prototype.binarySearch=function(e){for(var t=e.low,i=e.high,r=e.offset,n=0,o=0;t<=i;){if(n=t+Math.floor((i-t)/2),(o=this.getSizeAndPositionForIndex(n).offset)===r)return n;o<r?t=n+1:o>r&&(i=n-1)}return t>0?t-1:0},e.prototype.exponentialSearch=function(e){for(var t=e.index,i=e.offset,r=1;t<this.itemCount&&this.getSizeAndPositionForIndex(t).offset<i;)t+=r,r*=2;return this.binarySearch({high:Math.min(t,this.itemCount-1),low:Math.floor(t/2),offset:i})},e}(),_={overflow:"auto",willChange:"transform",WebkitOverflowScrolling:"touch"},E={position:"relative",width:"100%",minHeight:"100%"},O={position:"absolute",top:0,left:0,width:"100%"},F=d({},O,{position:"sticky"}),y=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemSizeGetter=function(e){return function(i){return t.getSize(i,e)}},t.sizeAndPositionManager=new g({itemCount:t.props.itemCount,itemSizeGetter:t.itemSizeGetter(t.props.itemSize),estimatedItemSize:t.getEstimatedItemSize()}),t.state={offset:t.props.scrollOffset||null!=t.props.scrollToIndex&&t.getOffsetForIndex(t.props.scrollToIndex)||0,scrollChangeReason:s.REQUESTED},t.styleCache={},t.getRef=function(e){t.rootNode=e},t.handleScroll=function(e){var i=t.props.onScroll,r=t.getNodeOffset();r<0||t.state.offset===r||e.target!==t.rootNode||(t.setState({offset:r,scrollChangeReason:s.OBSERVED}),"function"==typeof i&&i(r,e))},t}return function(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}(i,e),i.prototype.componentDidMount=function(){var e=this.props,t=e.scrollOffset,i=e.scrollToIndex;this.rootNode.addEventListener("scroll",this.handleScroll,{passive:!0}),null!=t?this.scrollTo(t):null!=i&&this.scrollTo(this.getOffsetForIndex(i))},i.prototype.componentWillReceiveProps=function(e){var t=this.props,i=t.estimatedItemSize,r=t.itemCount,n=t.itemSize,o=t.scrollOffset,a=t.scrollToAlignment,l=t.scrollToIndex,d=e.scrollToIndex!==l||e.scrollToAlignment!==a,u=e.itemCount!==r||e.itemSize!==n||e.estimatedItemSize!==i;e.itemSize!==n&&this.sizeAndPositionManager.updateConfig({itemSizeGetter:this.itemSizeGetter(e.itemSize)}),e.itemCount===r&&e.estimatedItemSize===i||this.sizeAndPositionManager.updateConfig({itemCount:e.itemCount,estimatedItemSize:this.getEstimatedItemSize(e)}),u&&this.recomputeSizes(),e.scrollOffset!==o?this.setState({offset:e.scrollOffset||0,scrollChangeReason:s.REQUESTED}):"number"==typeof e.scrollToIndex&&(d||u)&&this.setState({offset:this.getOffsetForIndex(e.scrollToIndex,e.scrollToAlignment,e.itemCount),scrollChangeReason:s.REQUESTED})},i.prototype.componentDidUpdate=function(e,t){var i=this.state,r=i.offset,n=i.scrollChangeReason;t.offset!==r&&n===s.REQUESTED&&this.scrollTo(r)},i.prototype.componentWillUnmount=function(){this.rootNode.removeEventListener("scroll",this.handleScroll)},i.prototype.scrollTo=function(e){var i=this.props.scrollDirection,r=void 0===i?t.ScrollDirection.VERTICAL:i;this.rootNode[b[r]]=e},i.prototype.getOffsetForIndex=function(e,i,r){void 0===i&&(i=this.props.scrollToAlignment),void 0===r&&(r=this.props.itemCount);var n=this.props.scrollDirection,o=void 0===n?t.ScrollDirection.VERTICAL:n;return(e<0||e>=r)&&(e=0),this.sizeAndPositionManager.getUpdatedOffsetForIndex({align:i,containerSize:this.props[v[o]],currentOffset:this.state&&this.state.offset||0,targetIndex:e})},i.prototype.recomputeSizes=function(e){void 0===e&&(e=0),this.styleCache={},this.sizeAndPositionManager.resetItem(e)},i.prototype.render=function(){var e,i=this,n=this.props,o=(n.estimatedItemSize,n.height),a=n.overscanCount,l=void 0===a?3:a,s=n.renderItem,u=(n.itemCount,n.itemSize,n.onItemsRendered),c=(n.onScroll,n.scrollDirection),f=void 0===c?t.ScrollDirection.VERTICAL:c,m=(n.scrollOffset,n.scrollToIndex,n.scrollToAlignment,n.stickyIndices),p=n.style,b=n.width,j=function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&(i[r[n]]=e[r[n]])}return i}(n,["estimatedItemSize","height","overscanCount","renderItem","itemCount","itemSize","onItemsRendered","onScroll","scrollDirection","scrollOffset","scrollToIndex","scrollToAlignment","stickyIndices","style","width"]),x=this.state.offset,h=this.sizeAndPositionManager.getVisibleRange({containerSize:this.props[v[f]]||0,offset:x,overscanCount:l}),g=h.start,O=h.stop,F=[],y=d({},_,p,{height:o,width:b}),w=d({},E,((e={})[v[f]]=this.sizeAndPositionManager.getTotalSize(),e));if(null!=m&&0!==m.length&&(m.forEach((function(e){return F.push(s({index:e,style:i.getStyle(e,!0)}))})),f===t.ScrollDirection.HORIZONTAL&&(w.display="flex")),void 0!==g&&void 0!==O){for(var P=g;P<=O;P++)null!=m&&m.includes(P)||F.push(s({index:P,style:this.getStyle(P,!1)}));"function"==typeof u&&u({startIndex:g,stopIndex:O})}return r.createElement("div",d({ref:this.getRef},j,{style:y}),r.createElement("div",{style:w},F))},i.prototype.getNodeOffset=function(){var e=this.props.scrollDirection,i=void 0===e?t.ScrollDirection.VERTICAL:e;return this.rootNode[b[i]]},i.prototype.getEstimatedItemSize=function(e){return void 0===e&&(e=this.props),e.estimatedItemSize||"number"==typeof e.itemSize&&e.itemSize||50},i.prototype.getSize=function(e,t){return"function"==typeof t?t(e):Array.isArray(t)?t[e]:t},i.prototype.getStyle=function(e,i){var r=this.styleCache[e];if(r)return r;var n,o,a=this.props.scrollDirection,l=void 0===a?t.ScrollDirection.VERTICAL:a,s=this.sizeAndPositionManager.getSizeAndPositionForIndex(e),u=s.size,c=s.offset;return this.styleCache[e]=i?d({},F,((n={})[v[l]]=u,n[x[l]]=c,n[h[l]]=-(c+u),n.zIndex=1,n)):d({},O,((o={})[v[l]]=u,o[j[l]]=c,o))},i.defaultProps={overscanCount:3,scrollDirection:t.ScrollDirection.VERTICAL,width:"100%"},i.propTypes={estimatedItemSize:n.number,height:n.oneOfType([n.number,n.string]).isRequired,itemCount:n.number.isRequired,itemSize:n.oneOfType([n.number,n.array,n.func]).isRequired,onScroll:n.func,onItemsRendered:n.func,overscanCount:n.number,renderItem:n.func.isRequired,scrollOffset:n.number,scrollToIndex:n.number,scrollToAlignment:n.oneOf([a.AUTO,a.START,a.CENTER,a.END]),scrollDirection:n.oneOf([t.ScrollDirection.HORIZONTAL,t.ScrollDirection.VERTICAL]),stickyIndices:n.arrayOf(n.number),style:n.object,width:n.oneOfType([n.number,n.string])},i}(r.PureComponent);t.default=y},71:function(e,t,i){e.exports=i(17)(7)},72:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(73);case"v8light":return i(75)}},73:function(e,t,i){var r=i(53),n=i(74);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var o={insert:"head",singleton:!1};r(n,o);e.exports=n.locals||{}},74:function(e,t,i){(t=i(54)(!1)).push([e.i,".indexPatternFieldEditor__previewFieldList{position:relative}.indexPatternFieldEditor__previewFieldList--ligthWeight{font-weight:400}.indexPatternFieldEditor__previewFieldList__item{border-bottom:1px solid #343741;height:40px;align-items:center;overflow:hidden}.indexPatternFieldEditor__previewFieldList__item--highlighted{background:#103148;font-weight:600}.indexPatternFieldEditor__previewFieldList__item__key,.indexPatternFieldEditor__previewFieldList__item__value{overflow:hidden}.indexPatternFieldEditor__previewFieldList__item__actions{flex-basis:24px !important}.indexPatternFieldEditor__previewFieldList__item__actionsBtn{display:none}.indexPatternFieldEditor__previewFieldList__item--pinned .indexPatternFieldEditor__previewFieldList__item__actionsBtn,.indexPatternFieldEditor__previewFieldList__item:hover .indexPatternFieldEditor__previewFieldList__item__actionsBtn{display:block}.indexPatternFieldEditor__previewFieldList__item__value .euiToolTipAnchor{width:100%}.indexPatternFieldEditor__previewFieldList__item__key__wrapper,.indexPatternFieldEditor__previewFieldList__item__value__wrapper{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;width:100%}.indexPatternFieldEditor__previewFieldList__showMore{position:absolute;width:100%;height:40px;bottom:-40px;display:flex;align-items:flex-end}\n",""]),e.exports=t},75:function(e,t,i){var r=i(53),n=i(76);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var o={insert:"head",singleton:!1};r(n,o);e.exports=n.locals||{}},76:function(e,t,i){(t=i(54)(!1)).push([e.i,".indexPatternFieldEditor__previewFieldList{position:relative}.indexPatternFieldEditor__previewFieldList--ligthWeight{font-weight:400}.indexPatternFieldEditor__previewFieldList__item{border-bottom:1px solid #D3DAE6;height:40px;align-items:center;overflow:hidden}.indexPatternFieldEditor__previewFieldList__item--highlighted{background:#e6f1fa;font-weight:600}.indexPatternFieldEditor__previewFieldList__item__key,.indexPatternFieldEditor__previewFieldList__item__value{overflow:hidden}.indexPatternFieldEditor__previewFieldList__item__actions{flex-basis:24px !important}.indexPatternFieldEditor__previewFieldList__item__actionsBtn{display:none}.indexPatternFieldEditor__previewFieldList__item--pinned .indexPatternFieldEditor__previewFieldList__item__actionsBtn,.indexPatternFieldEditor__previewFieldList__item:hover .indexPatternFieldEditor__previewFieldList__item__actionsBtn{display:block}.indexPatternFieldEditor__previewFieldList__item__value .euiToolTipAnchor{width:100%}.indexPatternFieldEditor__previewFieldList__item__key__wrapper,.indexPatternFieldEditor__previewFieldList__item__value__wrapper{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;width:100%}.indexPatternFieldEditor__previewFieldList__showMore{position:absolute;width:100%;height:40px;bottom:-40px;display:flex;align-items:flex-end}\n",""]),e.exports=t},77:function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(78);case"v8light":return i(80)}},78:function(e,t,i){var r=i(53),n=i(79);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var o={insert:"head",singleton:!1};r(n,o);e.exports=n.locals||{}},79:function(e,t,i){(t=i(54)(!1)).push([e.i,".indexPatternFieldEditor__previewPannel{display:flex;flex-direction:column;height:100%}.indexPatternFieldEditor__previewImageModal__wrapper{padding:16px}.indexPatternFieldEditor__previewImageModal__wrapper img{max-width:100%}.indexPatternFieldEditor__previewEmptySearchResult__title{font-weight:400}\n",""]),e.exports=t},80:function(e,t,i){var r=i(53),n=i(81);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var o={insert:"head",singleton:!1};r(n,o);e.exports=n.locals||{}},81:function(e,t,i){(t=i(54)(!1)).push([e.i,".indexPatternFieldEditor__previewPannel{display:flex;flex-direction:column;height:100%}.indexPatternFieldEditor__previewImageModal__wrapper{padding:16px}.indexPatternFieldEditor__previewImageModal__wrapper img{max-width:100%}.indexPatternFieldEditor__previewEmptySearchResult__title{font-weight:400}\n",""]),e.exports=t},93:function(e,t,i){"use strict";i.r(t),i.d(t,"FieldEditorFlyoutContentContainer",(function(){return Le}));var r=i(1),n=i.n(r),o=i(2),a=i(39),l=i(10),s=i(46);const d=({links:e})=>({runtimePainless:e.indexPatterns.runtimeFields,painlessSyntax:e.scriptedFields.painlessLangSpec}),u=e=>{var t,i,r,n;let a=null===(t=e.caused_by)||void 0===t?void 0:t.reason;const l=((e="")=>e.startsWith("Cannot cast from")?"CAST_ERROR":"UNKNOWN")(a);return"CAST_ERROR"===l&&(a=`${a} ${o.i18n.translate("indexPatternFieldEditor.editor.form.scriptEditor.castErrorMessage",{defaultMessage:"Verify that you have correctly set the runtime field type."})}`),{message:o.i18n.translate("indexPatternFieldEditor.editor.form.scriptEditor.compileErrorMessage",{defaultMessage:"Error compiling the painless script"}),position:null!==(i=e.position)&&void 0!==i?i:null,scriptStack:null!==(r=e.script_stack)&&void 0!==r?r:[],reason:null!==(n=a)&&void 0!==n?n:null,code:l}};i(22);var c=i(13),f=i(3),m=i(61),p=i.n(m),b=i(47),v=i.n(b),j=(i(63),i(0));let x=0;const h=Object(r.createContext)({addPanel:()=>({removePanel:()=>{},isFixedWidth:!1})}),g=(e,{innerWidth:t})=>Math.min(e,.8*t),_=Object(r.createContext)({registerFooter:()=>{},registerContent:()=>{}}),E=()=>{const e=Object(r.useContext)(_);if(void 0===e)throw new Error("useFlyoutPanel() must be used within a <flyoutPanelContext.Provider />");return e},O=({maxWidth:e,flyoutClassName:t,fixedPanelWidths:i=!1,...n})=>{const o=Object(r.useMemo)((()=>{const e=document.getElementsByClassName(t);return 0===e.length?null:e.item(0)}),[t]),[a,l]=Object(r.useState)({}),s=Object(r.useCallback)((e=>{l((t=>{const{[e]:i,...r}=t;return r}))}),[]),d=Object(r.useCallback)((e=>{const t=x++;return l((i=>({...i,[t]:e}))),{removePanel:s.bind(null,t),isFixedWidth:i}}),[s,i]),u=Object(r.useMemo)((()=>({addPanel:d})),[d]);return Object(r.useLayoutEffect)((()=>{if(!o)return;let t;if(i){const i=Object.values(a).reduce(((e,{width:t=0})=>e+t),0);t=Math.min(e,i),o.style.minWidth=`${g(t,window)}px`,o.style.maxWidth=`${g(t,window)}px`}else{const i=Math.min(100,Object.values(a).reduce(((e,{width:t=0})=>e+t),0));t=e*i/100,o.style.maxWidth=`${g(t,window)}px`}}),[a,e,i,t,o]),Object(j.jsx)(h.Provider,{value:u},Object(j.jsx)(f.EuiFlexGroup,p()({className:"fieldEditor__flyoutPanels",gutterSize:"none"},n)))},F=({children:e,width:t,className:i="",backgroundColor:n,border:o,"data-test-subj":a,...l})=>{const[s,d]=Object(r.useState)({hasContent:!1,hasFooter:!1}),[u,c]=Object(r.useState)({}),m=v()("fieldEditor__flyoutPanel",i,{"fieldEditor__flyoutPanel--pageBackground":"euiPageBackground"===n,"fieldEditor__flyoutPanel--emptyShade":"euiEmptyShade"===n,"fieldEditor__flyoutPanel--leftBorder":"left"===o,"fieldEditor__flyoutPanel--rightBorder":"right"===o,"fieldEditor__flyoutPanel--withContent":s.hasContent}),{addPanel:b}=(()=>{const e=Object(r.useContext)(h);if(void 0===e)throw new Error("<Panel /> must be used within a <Panels /> wrapper");return e})(),x=Object(r.useCallback)((()=>{d((e=>({...e,hasContent:!0})))}),[]),g=Object(r.useCallback)((()=>{d((e=>{if(!e.hasContent)throw new Error("You need to add a <FlyoutPanels.Content /> when you add a <FlyoutPanels.Footer />");return{...e,hasFooter:!0}}))}),[]),E=Object(r.useMemo)((()=>({registerContent:x,registerFooter:g})),[g,x]);return Object(r.useLayoutEffect)((()=>{const{removePanel:e,isFixedWidth:i}=b({width:t});return t&&c((e=>i?{...e,width:`${t}px`}:{...e,minWidth:`${t}%`})),e}),[t,b]),Object(j.jsx)(f.EuiFlexItem,{className:"fieldEditor__flyoutPanels__column",style:u,grow:!1,"data-test-subj":a},Object(j.jsx)(_.Provider,{value:E},Object(j.jsx)("div",p()({className:m},l),e)))},y=e=>{const{registerContent:t}=E();return Object(r.useEffect)((()=>{t()}),[t]),Object(j.jsx)("div",p()({className:"fieldEditor__flyoutPanel__content",tabIndex:0},e))},w=e=>Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(f.EuiFlyoutHeader,p()({className:"fieldEditor__flyoutPanel__header"},e)),Object(j.jsx)(f.EuiSpacer,null)),P=e=>{const{registerFooter:t}=E();return Object(r.useEffect)((()=>{t()}),[t]),Object(j.jsx)(f.EuiFlyoutFooter,p()({className:"fieldEditor__flyoutPanel__footer"},e))},S=Object(r.createContext)(void 0),C=({services:e,dataView:t,links:i,uiSettings:n,fieldTypeToProcess:o,fieldFormats:a,fieldFormatEditors:l,namesNotAllowed:s,existingConcreteFields:d,children:u})=>{const c=Object(r.useMemo)((()=>({dataView:t,fieldTypeToProcess:o,links:i,uiSettings:n,services:e,fieldFormats:a,fieldFormatEditors:l,namesNotAllowed:s,existingConcreteFields:d})),[t,o,e,i,n,a,l,s,d]);return Object(j.jsx)(S.Provider,{value:c},u)},M=()=>{const e=Object(r.useContext)(S);if(void 0===e)throw new Error("useFieldEditorContext must be used within a <FieldEditorContext />");return e};var T=i(16),I=i(6),L=i(48),R=i(68),k=i.n(R),N=i(25);const z=Object(r.createContext)(void 0),D={name:null,index:null,script:null,document:null,type:null,format:null},A=e=>{var t;const i="object"==typeof e?JSON.stringify(e):null!==(t=String(e))&&void 0!==t?t:"-";return Object(L.renderToString)(Object(j.jsx)(n.a.Fragment,null,i))},V=({children:e})=>{const t=Object(r.useRef)(0),i=Object(r.useRef)({type:null,script:void 0,documentId:void 0}),{dataView:n,fieldTypeToProcess:a,services:{search:l,notifications:s,api:{getFieldPreview:d}},fieldFormats:c}=M(),[f,m]=Object(r.useState)({fields:[],error:null}),[p,b]=Object(r.useState)(null),[v,x]=Object(r.useState)(D),[h,g]=Object(r.useState)({documents:[],currentIdx:0}),[_,E]=Object(r.useState)(!0),[O,F]=Object(r.useState)(!1),[y,w]=Object(r.useState)(!1),[P,S]=Object(r.useState)(null),[C,I]=Object(r.useState)("cluster"),[L,R]=Object(r.useState)({}),[V,B]=Object(r.useState)({isValidating:!1,isValid:!0,message:null}),{documents:W,currentIdx:U}=h,G=W[U],H=null==G?void 0:G._index,q=null==G?void 0:G._id,$=W.length,J=null!==P;let Z=!0;O||J||0!==W.length||(Z=!1);const{name:Q,document:Y,script:K,format:X,type:ee}=v,te=Object(r.useCallback)((e=>{x((t=>({...t,...e})))}),[]),ie=Object(r.useMemo)((()=>!!(H&&null!=K&&K.source&&ee)),[H,null==K?void 0:K.source,ee]),re=Object(r.useMemo)((()=>i.current.type!==ee||i.current.script!==(null==K?void 0:K.source)||i.current.documentId!==q),[ee,K,q]),ne=Object(r.useCallback)((e=>{m((t=>({...t,error:e})))}),[]),oe=Object(r.useCallback)((e=>{m((t=>{var i;const r=null===t.error||(null===(i=t.error)||void 0===i?void 0:i.code)===e?null:t.error;return{...t,error:r}}))}),[]),ae=Object(r.useCallback)((e=>{if(null!=X&&X.id){const i=c.getInstance(X.id,X.params);var t;if(i)return null!==(t=i.getConverterFor("html")(e))&&void 0!==t?t:JSON.stringify(e)}if(ee){const t=Object(N.castEsToKbnFieldTypeName)(ee),r=c.getDefaultInstance(t);var i;if(r)return null!==(i=r.getConverterFor("html")(e))&&void 0!==i?i:JSON.stringify(e)}return A(e)}),[X,ee,c]),le=Object(r.useCallback)((async(e=50)=>{if("number"!=typeof e)throw new Error('The "limit" option must be a number');i.current.documentId=void 0,F(!0),m({fields:[],error:null});const[t,r]=await l.search({params:{index:n.title,body:{size:e}}}).toPromise().then((e=>[e,null])).catch((e=>[null,e]));F(!1),S(null);const a=Boolean(r)?{code:"ERR_FETCHING_DOC",error:{message:r.toString(),reason:o.i18n.translate("indexPatternFieldEditor.fieldPreview.error.errorLoadingSampleDocumentsDescription",{defaultMessage:"Error loading sample documents."})}}:null;b(a),null===a&&g({documents:t?t.rawResponse.hits.hits:[],currentIdx:0})}),[n,l]),se=Object(r.useCallback)((async e=>{if(!Boolean(e.trim()))return;i.current.documentId=void 0,F(!0);const[t,r]=await l.search({params:{index:n.title,body:{size:1,query:{ids:{values:[e]}}}}}).toPromise().then((e=>[e,null])).catch((e=>[null,e]));F(!1);const a=(null==t?void 0:t.rawResponse.hits.total)>0,s=a?t.rawResponse.hits.hits:[],d=Boolean(r)?{code:"ERR_FETCHING_DOC",error:{message:r.toString(),reason:o.i18n.translate("indexPatternFieldEditor.fieldPreview.error.errorLoadingDocumentDescription",{defaultMessage:"Error loading document."})}}:!1===a?{code:"DOC_NOT_FOUND",error:{message:o.i18n.translate("indexPatternFieldEditor.fieldPreview.error.documentNotFoundDescription",{defaultMessage:"Document ID not found"})}}:null;b(d),null===d?g({documents:s,currentIdx:0}):w(!1)}),[n,l]),de=Object(r.useCallback)((async()=>{if(V.isValidating)return;if(!ie||!re||!1===V.isValid)return void w(!1);i.current={type:ee,script:null==K?void 0:K.source,documentId:q};const e=++t.current,r=await d({index:n.title,document:Y,context:`${ee}_field`,script:K,documentId:q});if(e!==t.current)return;const{error:a}=r;if(a){const e=o.i18n.translate("indexPatternFieldEditor.fieldPreview.errorTitle",{defaultMessage:"Failed to load field preview"});return s.toasts.addError(a,{title:e}),void w(!1)}if(r.data){const{values:e,error:t}=r.data;if(t)m({fields:[{key:null!=Q?Q:"",value:"",formattedValue:A("")}],error:{code:"PAINLESS_SCRIPT_ERROR",error:u(t)}});else{const[t]=e,i=ae(t);m({fields:[{key:Q,value:t,formattedValue:i}],error:null})}}w(!1)}),[Q,ee,K,Y,q,d,s.toasts,ae,ie,V,re,n.title]),ue=Object(r.useCallback)((()=>{g(U>=$-1?e=>({...e,currentIdx:0}):e=>({...e,currentIdx:e.currentIdx+1}))}),[U,$]),ce=Object(r.useCallback)((()=>{g(0===U?e=>({...e,currentIdx:$-1}):e=>({...e,currentIdx:e.currentIdx-1}))}),[U,$]),fe=Object(r.useCallback)((()=>{t.current=0,g({documents:[],currentIdx:0}),m({fields:[],error:null}),I("cluster"),w(!1),F(!1)}),[]),me=Object(r.useMemo)((()=>({fields:f.fields,error:f.error,isPreviewAvailable:Z,isLoadingPreview:y,params:{value:v,update:te},currentDocument:{value:G,id:J?P:q,isLoading:O,isCustomId:J},documents:{loadSingle:S,loadFromCluster:le,fetchDocError:p},navigation:{isFirstDoc:0===U,isLastDoc:U>=$-1,next:ue,prev:ce},panel:{isVisible:_,setIsVisible:E},from:{value:C,set:I},reset:fe,pinnedFields:{value:L,set:R},validation:{setScriptEditorValidation:B}})),[f,p,v,Z,y,te,G,q,J,le,O,P,U,$,ue,ce,_,C,fe,L]);return Object(r.useEffect)((()=>{ie&&re&&w(!0)}),[ie,re,null==K?void 0:K.source,ee,q]),Object(r.useEffect)((()=>{null!==P&&Boolean(P.trim())&&F(!0)}),[P]),Object(r.useEffect)((()=>{_&&le()}),[_,le,a]),Object(r.useEffect)((()=>{te({document:null==G?void 0:G._source,index:null==G?void 0:G._index})}),[G,te]),Object(r.useEffect)((()=>{m((e=>{const{fields:{0:t}}=e,i=null===K&&Boolean(Y)?Object(T.get)(Y,null!=Q?Q:""):null==t?void 0:t.value,r=ae(i);return{...e,fields:[{...t,key:null!=Q?Q:"",value:i,formattedValue:r}]}}))}),[Q,K,Y,ae]),Object(r.useEffect)((()=>{void 0===(null==K?void 0:K.source)&&(i.current.script=void 0,ne(null))}),[null==K?void 0:K.source,ne]),Object(r.useEffect)((()=>{if(!V.isValidating)if(!1===V.isValid){var e;w(!1);const t=void 0===(null==K?void 0:K.source)?null:{code:"PAINLESS_SYNTAX_ERROR",error:{reason:null!==(e=V.message)&&void 0!==e?e:o.i18n.translate("indexPatternFieldEditor.fieldPreview.error.painlessSyntax",{defaultMessage:"Invalid Painless syntax"})}};ne(t),i.current.script=null==K?void 0:K.source}else oe("PAINLESS_SYNTAX_ERROR")}),[V,null==K?void 0:K.source,ne,oe]),k()(de,500,[de]),k()((()=>{null!==P&&se(P)}),500,[P]),Object(j.jsx)(z.Provider,{value:me},e)},B=()=>{const e=Object(r.useContext)(z);if(void 0===e)throw new Error("useFieldPreviewContext must be used within a <FieldPreviewProvider />");return e},W=()=>Object(j.jsx)("div",{"data-test-subj":"isUpdatingIndicator"},Object(j.jsx)(f.EuiFlexGroup,{gutterSize:"xs"},Object(j.jsx)(f.EuiFlexItem,{grow:!1},Object(j.jsx)(f.EuiLoadingSpinner,{size:"m"})),Object(j.jsx)(f.EuiFlexItem,{grow:!1},o.i18n.translate("indexPatternFieldEditor.fieldPreview.updatingPreviewLabel",{defaultMessage:"Updating..."})))),U={title:o.i18n.translate("indexPatternFieldEditor.fieldPreview.title",{defaultMessage:"Preview"}),customData:o.i18n.translate("indexPatternFieldEditor.fieldPreview.subTitle.customData",{defaultMessage:"Custom data"})},G=()=>{const{dataView:e}=M(),{from:t,currentDocument:{isLoading:i}}=B();return Object(j.jsx)("div",null,Object(j.jsx)(f.EuiFlexGroup,{alignItems:"center"},Object(j.jsx)(f.EuiFlexItem,{grow:!1},Object(j.jsx)(f.EuiTitle,{size:"s"},Object(j.jsx)("h2",{"data-test-subj":"title"},U.title))),i&&Object(j.jsx)(f.EuiFlexItem,{"data-test-subj":"isFetchingDocumentIndicator"},Object(j.jsx)(W,null))),Object(j.jsx)(f.EuiText,null,Object(j.jsx)(f.EuiTextColor,{color:"subdued","data-test-subj":"subTitle"},o.i18n.translate("indexPatternFieldEditor.fieldPreview.subTitle",{defaultMessage:"From: {from}",values:{from:"cluster"===t.value?e.title:U.customData}}))))},H=()=>Object(j.jsx)(f.EuiFlexGroup,{style:{height:"100%"},"data-test-subj":"emptyPrompt"},Object(j.jsx)(f.EuiFlexItem,null,Object(j.jsx)(f.EuiEmptyPrompt,{iconType:"inspect",title:Object(j.jsx)("h2",null,o.i18n.translate("indexPatternFieldEditor.fieldPreview.emptyPromptTitle",{defaultMessage:"Preview"})),titleSize:"s",body:Object(j.jsx)(f.EuiText,{size:"s"},Object(j.jsx)(f.EuiTextColor,{color:"subdued"},Object(j.jsx)("p",null,o.i18n.translate("indexPatternFieldEditor.fieldPreview.emptyPromptDescription",{defaultMessage:"Enter the name of an existing field or define a script to view a preview of the calculated output."}))))}))),q=()=>{const{currentDocument:{id:e,isCustomId:t},documents:{loadSingle:i,loadFromCluster:n,fetchDocError:a},navigation:{prev:l,next:s}}=B(),d="DOC_NOT_FOUND"===(null==a?void 0:a.code),u=!1===t,c=Object(r.useCallback)((e=>{const t=e.target.value;i(t)}),[i]);return Object(j.jsx)("div",null,Object(j.jsx)(f.EuiFlexGroup,{gutterSize:"s"},Object(j.jsx)(f.EuiFlexItem,null,Object(j.jsx)(f.EuiFormRow,{label:o.i18n.translate("indexPatternFieldEditor.fieldPreview.documentIdField.label",{defaultMessage:"Document ID"}),isInvalid:d,fullWidth:!0},Object(j.jsx)(f.EuiFieldText,{isInvalid:d,value:null!=e?e:"",onChange:c,fullWidth:!0,"data-test-subj":"documentIdField"})),t&&Object(j.jsx)("span",null,Object(j.jsx)(f.EuiButtonEmpty,{color:"primary",size:"xs",flush:"left",onClick:()=>n(),"data-test-subj":"loadDocsFromClusterButton"},o.i18n.translate("indexPatternFieldEditor.fieldPreview.documentIdField.loadDocumentsFromCluster",{defaultMessage:"Load documents from cluster"})))),u&&Object(j.jsx)(f.EuiFlexItem,{grow:!1,"data-test-subj":"documentsNav"},Object(j.jsx)(f.EuiFlexGroup,{gutterSize:"s",alignItems:"flexEnd"},Object(j.jsx)(f.EuiFlexItem,{grow:!1},Object(j.jsx)(f.EuiButtonIcon,{display:"base",size:"m",onClick:l,iconType:"arrowLeft","data-test-subj":"goToPrevDocButton","aria-label":o.i18n.translate("indexPatternFieldEditor.fieldPreview.documentNav.previousArialabel",{defaultMessage:"Previous document"})})),Object(j.jsx)(f.EuiFlexItem,{grow:!1},Object(j.jsx)(f.EuiButtonIcon,{display:"base",size:"m",onClick:s,iconType:"arrowRight","data-test-subj":"goToNextDocButton","aria-label":o.i18n.translate("indexPatternFieldEditor.fieldPreview.documentNav.nextArialabel",{defaultMessage:"Next document"})}))))))},$=()=>{var e;const{documents:{fetchDocError:t}}=B();return null===t?null:Object(j.jsx)(f.EuiCallOut,{title:o.i18n.translate("indexPatternFieldEditor.fieldPreview.errorCallout.title",{defaultMessage:"Error fetching document"}),color:"danger",iconType:"alert",role:"alert","data-test-subj":"fetchDocError"},Object(j.jsx)("p",{"data-test-subj":"title"},null!==(e=t.error.message)&&void 0!==e?e:t.error.reason))},J=e=>{const t=new RegExp("max-width:[^;]+;","gm");return t.test(e)?e.replace(t,"max-width: 100%;"):e},Z=({imgHTML:e,closeModal:t})=>Object(j.jsx)(f.EuiModal,{onClose:t},Object(j.jsx)(f.EuiModalBody,null,Object(j.jsx)("div",{className:"indexPatternFieldEditor__previewImageModal__wrapper",dangerouslySetInnerHTML:{__html:J(e)}}))),Q=({field:{key:e,value:t,formattedValue:i,isPinned:a=!1},toggleIsPinned:l,hasScriptError:s,isFromScript:d=!1})=>{const{isLoadingPreview:u}=B(),[c,m]=Object(r.useState)(!1),p=v()("indexPatternFieldEditor__previewFieldList__item",{"indexPatternFieldEditor__previewFieldList__item--highlighted":d,"indexPatternFieldEditor__previewFieldList__item--pinned":a}),b=null==i?void 0:i.includes("<img"),x=e=>Object(j.jsx)(f.EuiToolTip,{position:"top",content:"string"!=typeof t?JSON.stringify(t):t},e);return Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(f.EuiFlexGroup,{className:p,gutterSize:"none","data-test-subj":"listItem"},Object(j.jsx)(f.EuiFlexItem,{className:"indexPatternFieldEditor__previewFieldList__item__key"},Object(j.jsx)("div",{className:"indexPatternFieldEditor__previewFieldList__item__key__wrapper","data-test-subj":"key"},d&&!Boolean(e)?Object(j.jsx)("span",{className:"indexPatternFieldEditor__previewFieldList--ligthWeight"},Object(j.jsx)(f.EuiTextColor,{color:"subdued"},o.i18n.translate("indexPatternFieldEditor.fieldPreview.fieldNameNotSetLabel",{defaultMessage:"Field name not set"}))):e)),Object(j.jsx)(f.EuiFlexItem,{className:"indexPatternFieldEditor__previewFieldList__item__value","data-test-subj":"value"},d&&u?Object(j.jsx)("span",{className:"indexPatternFieldEditor__previewFieldList--ligthWeight"},Object(j.jsx)(W,null)):s?Object(j.jsx)("div",null,Object(j.jsx)(f.EuiBadge,{iconType:"alert",color:"danger","data-test-subj":"scriptErrorBadge"},o.i18n.translate("indexPatternFieldEditor.fieldPreview.scriptErrorBadgeLabel",{defaultMessage:"Script error"}))):d&&void 0===t?Object(j.jsx)("span",{className:"indexPatternFieldEditor__previewFieldList--ligthWeight"},Object(j.jsx)(f.EuiTextColor,{color:"subdued"},o.i18n.translate("indexPatternFieldEditor.fieldPreview.valueNotSetLabel",{defaultMessage:"Value not set"}))):b?Object(j.jsx)(f.EuiButtonEmpty,{color:"text",onClick:()=>m(!0),iconType:"image"},o.i18n.translate("indexPatternFieldEditor.fieldPreview.viewImageButtonLabel",{defaultMessage:"View image"})):x(void 0!==i?Object(j.jsx)("span",{className:"indexPatternFieldEditor__previewFieldList__item__value__wrapper",dangerouslySetInnerHTML:{__html:i}}):Object(j.jsx)("span",{className:"indexPatternFieldEditor__previewFieldList__item__value__wrapper"},JSON.stringify(t)))),Object(j.jsx)(f.EuiFlexItem,{className:"indexPatternFieldEditor__previewFieldList__item__actions",grow:!1},l&&Object(j.jsx)(f.EuiButtonIcon,{onClick:()=>{l(e)},color:"text",iconType:"pinFilled","data-test-subj":"pinFieldButton","aria-label":o.i18n.translate("indexPatternFieldEditor.fieldPreview.pinFieldButtonLabel",{defaultMessage:"Pin field"}),className:"indexPatternFieldEditor__previewFieldList__item__actionsBtn"}))),c&&Object(j.jsx)(Z,{imgHTML:i,closeModal:()=>m(!1)}))};var Y=i(70),K=i.n(Y);i(72);function X(e){return e.replace(/[-\[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}const ee=({height:e,clearSearch:t,searchValue:i=""})=>{const{dataView:a}=M(),{currentDocument:{value:l},pinnedFields:{value:s,set:d}}=B(),[u,c]=Object(r.useState)(!1),{fields:{getAll:m}}=a,p=Object(r.useMemo)((()=>m()),[m]),b=Object(r.useMemo)((()=>p.map((({name:e,displayName:t})=>{const i=Object(T.get)(null==l?void 0:l._source,e);return{key:t,value:i,formattedValue:A(i),isPinned:!1}})).filter((({value:e})=>void 0!==e))),[p,null==l?void 0:l._source]),v=Object(r.useMemo)((()=>{const e=[],t=[];return b.forEach((i=>{s[i.key]?e.push({...i,isPinned:!0}):t.push({...i,isPinned:!1})})),[...e,...t]}),[b,s]),{filteredFields:x,totalFields:h}=Object(r.useMemo)((()=>{const e=""===i.trim()?v:v.filter((({key:e})=>function(e,t){const i=`.*${e.split("").map(X).join(".*")}.*`;return new RegExp(i,"i").test(t)}(i,e))),t=e.length;return u?{filteredFields:e,totalFields:t}:{filteredFields:e.filter(((e,t)=>t<7)),totalFields:t}}),[v,u,i]),g=""!==i.trim()&&0===h,_=Math.min(40*x.length,e-40),E=Object(r.useCallback)((()=>{c((e=>!e))}),[]),O=Object(r.useCallback)((e=>{d((t=>{const i=!t[e];return{...t,[e]:i}}))}),[d]);return void 0===l||-1===e?null:Object(j.jsx)("div",{className:"indexPatternFieldEditor__previewFieldList"},g?Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(f.EuiSpacer,null),Object(j.jsx)(f.EuiEmptyPrompt,{iconType:"search",title:Object(j.jsx)(f.EuiTextColor,{color:"subdued"},Object(j.jsx)("h3",{className:"indexPatternFieldEditor__previewEmptySearchResult__title"},o.i18n.translate("indexPatternFieldEditor.fieldPreview.searchResult.emptyPromptTitle",{defaultMessage:"No matching fields in this data view"}))),titleSize:"xs",actions:Object(j.jsx)(f.EuiButton,{onClick:t,"data-test-subj":"clearSearchButton"},o.i18n.translate("indexPatternFieldEditor.fieldPreview.searchResult.emptyPrompt.clearSearchButtonLabel",{defaultMessage:"Clear search"})),"data-test-subj":"emptySearchResult"})):Object(j.jsx)(K.a,{style:{overflowX:"hidden"},width:"100%",height:_,itemCount:x.length,itemSize:40,overscanCount:4,renderItem:({index:e,style:t})=>{const i=x[e];return Object(j.jsx)("div",{key:i.key,style:t,"data-test-subj":"indexPatternFieldList"},Object(j.jsx)(Q,{key:i.key,field:i,toggleIsPinned:O}))}}),h<=7?null:Object(j.jsx)("div",{className:"indexPatternFieldEditor__previewFieldList__showMore"},Object(j.jsx)(f.EuiButtonEmpty,{onClick:E,flush:"left"},u?o.i18n.translate("indexPatternFieldEditor.fieldPreview.showLessFieldsButtonLabel",{defaultMessage:"Show less"}):o.i18n.translate("indexPatternFieldEditor.fieldPreview.showMoreFieldsButtonLabel",{defaultMessage:"Show more"}))))};i(77);const te=()=>{const[e,t]=Object(r.useState)(-1),[i,a]=Object(r.useState)(""),{params:{value:{name:l,script:s,format:d}},fields:u,error:c,documents:{fetchDocError:m},reset:p,isPreviewAvailable:b}=B(),v=null===l&&null===s&&null===d||!(Boolean(c)||u.length>0)&&(null===l&&null===d),x=null===m,h=!1===b&&null===m,g=Object(r.useCallback)((({height:e})=>{t(e)}),[]);return Object(r.useEffect)((()=>p),[p]),Object(j.jsx)("div",{className:"indexPatternFieldEditor__previewPannel",tabIndex:0},v?Object(j.jsx)(H,null):Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(G,null),Object(j.jsx)(f.EuiSpacer,null),h?Object(j.jsx)(f.EuiCallOut,{title:o.i18n.translate("indexPatternFieldEditor.fieldPreview.notAvailableWarningCallout.title",{defaultMessage:"Preview not available"}),color:"warning",iconType:"alert",role:"alert","data-test-subj":"previewNotAvailableCallout"},Object(j.jsx)("p",null,o.i18n.translate("indexPatternFieldEditor.fieldPreview.notAvailableWarningCallout.description",{defaultMessage:"Runtime field preview is disabled because no documents could be fetched from the cluster."}))):Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(q,null),Object(j.jsx)(f.EuiSpacer,{size:"s"}),x&&Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(f.EuiFieldSearch,{value:i,onChange:e=>a(e.target.value),placeholder:o.i18n.translate("indexPatternFieldEditor.fieldPreview.filterFieldsPlaceholder",{defaultMessage:"Filter fields"}),fullWidth:!0,"data-test-subj":"filterFieldsInput"}),Object(j.jsx)(f.EuiSpacer,{size:"s"})),Object(j.jsx)($,null),Object(j.jsx)(f.EuiSpacer,{size:"s"}),x&&Object(j.jsx)(n.a.Fragment,null,(()=>{if(0===u.length)return null;const[e]=u;return Object(j.jsx)("ul",null,Object(j.jsx)("li",{"data-test-subj":"fieldPreviewItem"},Object(j.jsx)(Q,{field:e,isFromScript:!0,hasScriptError:Boolean(c)})))})(),Object(j.jsx)(f.EuiResizeObserver,{onResize:g},(t=>Object(j.jsx)("div",{ref:t,style:{flex:1}},Object(j.jsx)(ee,{height:e,clearSearch:()=>a(""),searchValue:i,key:e}))))))))},ie=[{label:"Keyword",value:"keyword"},{label:"Long",value:"long"},{label:"Double",value:"double"},{label:"Date",value:"date"},{label:"IP",value:"ip"},{label:"Boolean",value:"boolean"},{label:"Geo point",value:"geo_point"}],{containsCharsField:re,emptyField:ne,numberGreaterThanField:oe}=I.h,ae={invalidScriptErrorMessage:o.i18n.translate("indexPatternFieldEditor.editor.form.scriptEditorPainlessValidationMessage",{defaultMessage:"Invalid Painless script."})},le={name:{label:o.i18n.translate("indexPatternFieldEditor.editor.form.nameLabel",{defaultMessage:"Name"}),validations:[{validator:ne(o.i18n.translate("indexPatternFieldEditor.editor.form.validations.nameIsRequiredErrorMessage",{defaultMessage:"A name is required."}))},{validator:re({message:o.i18n.translate("indexPatternFieldEditor.editor.form.validations.starCharacterNotAllowedValidationErrorMessage",{defaultMessage:"The field cannot have * in the name."}),chars:"*"})}]},type:{label:o.i18n.translate("indexPatternFieldEditor.editor.form.runtimeTypeLabel",{defaultMessage:"Type"}),defaultValue:[ie[0]],fieldsToValidateOnChange:["script.source"]},script:{source:{label:o.i18n.translate("indexPatternFieldEditor.editor.form.defineFieldLabel",{defaultMessage:"Define script"}),validations:[{validator:ne(o.i18n.translate("indexPatternFieldEditor.editor.form.validations.scriptIsRequiredErrorMessage",{defaultMessage:"A script is required to set the field value."}))},{validator:async({customData:{provider:e}})=>{const t=await e();if(t&&"PAINLESS_SCRIPT_ERROR"===t.code)return{message:ae.invalidScriptErrorMessage}},isAsync:!0}]}},customLabel:{label:o.i18n.translate("indexPatternFieldEditor.editor.form.customLabelLabel",{defaultMessage:"Custom label"}),validations:[{validator:ne(o.i18n.translate("indexPatternFieldEditor.editor.form.validations.customLabelIsRequiredErrorMessage",{defaultMessage:"Give a label to the field."}))}]},popularity:{label:o.i18n.translate("indexPatternFieldEditor.editor.form.popularityLabel",{defaultMessage:"Popularity"}),validations:[{validator:ne(o.i18n.translate("indexPatternFieldEditor.editor.form.validations.popularityIsRequiredErrorMessage",{defaultMessage:"Give a popularity to the field."}))},{validator:oe({than:0,allowEquality:!0,message:o.i18n.translate("indexPatternFieldEditor.editor.form.validations.popularityGreaterThan0ErrorMessage",{defaultMessage:"The popularity must be zero or greater."})})}]},__meta__:{isCustomLabelVisible:{defaultValue:!1},isValueVisible:{defaultValue:!1},isFormatVisible:{defaultValue:!1},isPopularityVisible:{defaultValue:!1}}},se=e=>({value:t})=>{if(e.includes(t))return{message:o.i18n.translate("indexPatternFieldEditor.editor.runtimeFieldsEditor.existRuntimeFieldNamesValidationErrorMessage",{defaultMessage:"A field with this name already exists."})}},de=({isDisabled:e=!1})=>Object(j.jsx)(I.f,{path:"type"},(({label:t,value:i,setValue:r})=>void 0===i?null:Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(f.EuiFormRow,{label:t,fullWidth:!0},Object(j.jsx)(f.EuiComboBox,{placeholder:o.i18n.translate("indexPatternFieldEditor.editor.form.runtimeType.placeholderLabel",{defaultMessage:"Select a type"}),singleSelection:{asPlainText:!0},options:ie,selectedOptions:i,onChange:e=>{0!==e.length&&r(e)},isClearable:!1,isDisabled:e,"data-test-subj":"typeField","aria-label":o.i18n.translate("indexPatternFieldEditor.editor.form.typeSelectAriaLabel",{defaultMessage:"Type select"}),"aria-controls":"runtimeFieldScript",fullWidth:!0}))))),ue=()=>Object(j.jsx)(I.f,{path:"customLabel",component:I.d}),ce=()=>Object(j.jsx)(I.f,{path:"popularity",component:I.c,componentProps:{euiFieldProps:{"data-test-subj":"editorFieldCount"}}});var fe=i(50),me=i(51);const pe=e=>{switch(e){case"keyword":return"string_script_field_script_field";case"long":return"long_script_field_script_field";case"double":return"double_script_field_script_field";case"date":return"date_script_field";case"ip":return"ip_script_field_script_field";case"boolean":return"boolean_script_field_script_field";default:return"string_script_field_script_field"}},be=({existingConcreteFields:e,links:t})=>{const i=Object(r.useRef)(null),a=Object(r.useRef)(),l=Object(r.useRef)(""),{error:d,isLoadingPreview:u,isPreviewAvailable:m,currentDocument:{isLoading:p,value:b},validation:{setScriptEditorValidation:v}}=B(),[x,h]=Object(I.k)(void 0),[g,_]=Object(r.useState)(pe(le.type.defaultValue[0].value)),E=null==b?void 0:b._id,O=Object(r.useMemo)((()=>s.PainlessLang.getSuggestionProvider(g,e)),[g,e]),{validateFields:F}=Object(I.m)(),y=Object(r.useCallback)((({type:e})=>{void 0!==e&&_(pe(e[0].value)),m&&h(void 0)}),[h,m]);Object(I.n)({watch:["type","script.source"],onChange:y});const w=Object(r.useCallback)((async()=>(await Object(me.firstValueFrom)(x.pipe(Object(fe.first)((e=>void 0!==e&&(!e.isFetchingDoc&&!e.isLoadingPreview)))))).error),[x]),P=Object(r.useCallback)((e=>{i.current=e,a.current&&a.current.unsubscribe(),a.current=s.PainlessLang.validation$().subscribe((({isValid:e,isValidating:t,errors:i})=>{var r,n;v({isValid:e,isValidating:t,message:null!==(r=null===(n=i[0])||void 0===n?void 0:n.message)&&void 0!==r?r:null})}))}),[v]),S=Object(r.useCallback)((e=>{var t;const r=null===(t=i.current)||void 0===t?void 0:t.getModel();r&&s.monaco.editor.setModelMarkers(r,s.PainlessLang.ID,e)}),[]),C=Object(r.useCallback)((e=>{var t;const r=null===(t=i.current)||void 0===t?void 0:t.getModel();if(null!==e.position&&Boolean(r)){const{offset:t}=e.position,i=(({reason:e},t)=>({startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:t.lineNumber,endColumn:t.column+1,message:e,severity:s.monaco.MarkerSeverity.Error}))(e,r.getPositionAt(t));S(i?[i]:[])}}),[S]);return Object(r.useEffect)((()=>{""!==l.current.trim()&&void 0!==E&&F(["script.source"])}),[E,F]),Object(r.useEffect)((()=>{h({isFetchingDoc:p,isLoadingPreview:u,error:d})}),[h,p,u,d]),Object(r.useEffect)((()=>{"PAINLESS_SCRIPT_ERROR"===(null==d?void 0:d.code)?C(d.error):null===d&&S([])}),[d,C,S]),Object(r.useEffect)((()=>()=>{a.current&&a.current.unsubscribe()}),[]),Object(j.jsx)(I.f,{path:"script.source",validationDataProvider:w},(({value:e,setValue:i,label:r,isValid:a,getErrorsMessages:u})=>{let m=u();return d&&(m=d.error.reason),l.current=e,Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(f.EuiFormRow,{label:r,hasChildLabel:!1,id:"runtimeFieldScript",error:m,isInvalid:!a,helpText:Object(j.jsx)(c.FormattedMessage,{id:"indexPatternFieldEditor.editor.form.source.scriptFieldHelpText",defaultMessage:"Runtime fields without a script retrieve values from {source}. If the field doesn't exist in _source, a search request returns no value. {learnMoreLink}",values:{learnMoreLink:Object(j.jsx)(f.EuiLink,{href:t.runtimePainless,target:"_blank",external:!0,"data-test-subj":"painlessSyntaxLearnMoreLink"},o.i18n.translate("indexPatternFieldEditor.editor.form.script.learnMoreLinkText",{defaultMessage:"Learn about script syntax."})),source:Object(j.jsx)(f.EuiCode,null,"_source")}}),fullWidth:!0},Object(j.jsx)(I.a,{languageId:s.PainlessLang.ID,suggestionProvider:O,width:"99%",height:"210px",value:e,onChange:i,editorDidMount:P,options:{fontSize:12,minimap:{enabled:!1},scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent",automaticLayout:!0,suggest:{snippetsPreventQuickSuggestions:!1}},"data-test-subj":"scriptField","aria-label":o.i18n.translate("indexPatternFieldEditor.editor.form.scriptEditorAriaLabel",{defaultMessage:"Script editor"})})))}))},ve=n.a.memo(be);var je=i(21);const xe=()=>{const{dataView:e,uiSettings:t,fieldFormats:i,fieldFormatEditors:o}=M(),a=Object(r.useRef)(!1),[{type:l}]=Object(I.n)({watch:["name","type"]}),{getFields:s,isSubmitted:d}=Object(I.m)(),[u,c]=Object(r.useState)(),m=l.reduce(((e,t)=>(void 0!==t.value&&e.push(t.value),e)),[]);return Object(r.useEffect)((()=>{void 0===u?s().format.setErrors([]):s().format.setErrors([{message:u}])}),[u,s]),Object(r.useEffect)((()=>{a.current&&s().format.reset(),a.current=!0}),[l,s]),Object(j.jsx)(I.f,{path:"format"},(({setValue:r,errors:a,value:l})=>Object(j.jsx)(n.a.Fragment,null,d&&a.length>0&&Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(f.EuiCallOut,{title:a.map((e=>e.message)),color:"danger",iconType:"cross","data-test-subj":"formFormatError"}),Object(j.jsx)(f.EuiSpacer,{size:"m"})),Object(j.jsx)(je.a,{esTypes:m||["keyword"],indexPattern:e,fieldFormatEditors:o,fieldFormats:i,uiSettings:t,onChange:r,onError:c,value:l,key:m.join(", ")}))))},he=({title:e,description:t,children:i,formFieldPath:r,withDividerRule:o=!1,"data-test-subj":a})=>{const[l]=Object(I.n)({watch:r}),s=Boolean(Object(T.get)(l,r));return Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(f.EuiFlexGroup,{"data-test-subj":null!=a?a:"formRow"},Object(j.jsx)(f.EuiFlexItem,{grow:!1},Object(j.jsx)(I.f,{path:r,component:I.e,componentProps:{euiFieldProps:{label:e,showLabel:!1,"data-test-subj":"toggle"}}})),Object(j.jsx)(f.EuiFlexItem,null,Object(j.jsx)("div",null,Object(j.jsx)(f.EuiTitle,{size:"xs"},Object(j.jsx)("h3",null,e)),Object(j.jsx)(f.EuiSpacer,{size:"xs"}),Object(j.jsx)(f.EuiText,{size:"s",color:"subdued"},t),s&&Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(f.EuiSpacer,{size:"l"}),i)))),o&&Object(j.jsx)(f.EuiHorizontalRule,null))},ge=({children:e})=>{const[t,i]=Object(r.useState)(!1);return Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(f.EuiButtonEmpty,{onClick:()=>{i(!t)},flush:"left","data-test-subj":"toggleAdvancedSetting"},t?o.i18n.translate("indexPatternFieldEditor.editor.form.advancedSettings.hideButtonLabel",{defaultMessage:"Hide advanced settings"}):o.i18n.translate("indexPatternFieldEditor.editor.form.advancedSettings.showButtonLabel",{defaultMessage:"Show advanced settings"})),Object(j.jsx)("div",{style:{display:t?"block":"none"},"data-test-subj":"advancedSettings"},Object(j.jsx)(f.EuiSpacer,{size:"m"}),Object(j.jsx)("div",null,e)))},_e=o.i18n.translate("indexPatternFieldEditor.editor.form.changeWarning",{defaultMessage:"Changing name or type can break searches and visualizations that rely on this field."}),Ee=e=>{let t;if(e.type){var i;const r=null===(i=ie.find((({value:t})=>t===e.type)))||void 0===i?void 0:i.label;t=[{label:null!=r?r:e.type,value:e.type}]}else t=[ie[0]];return{...e,type:t,__meta__:{isCustomLabelVisible:void 0!==e.customLabel,isValueVisible:void 0!==e.script,isFormatVisible:void 0!==e.format,isPopularityVisible:void 0!==e.popularity}}},Oe=e=>{const{__meta__:t,type:i,...r}=e;return{type:i[0].value,...r}},Fe=({field:e,onChange:t,onFormModifiedChange:i})=>{var a,l;const{links:s,namesNotAllowed:d,existingConcreteFields:u,fieldTypeToProcess:m}=M(),{params:{update:p}}=B(),{form:b}=Object(I.l)({defaultValue:e,schema:le,deserializer:Ee,serializer:Oe}),{submit:v,isValid:x,isSubmitted:h,getFields:g,isSubmitting:_}=b,E=((e,t)=>{var i;const r=le.name;return e?{...r,validations:[...null!==(i=r.validations)&&void 0!==i?i:[],{validator:se(e.filter((e=>e!==(null==t?void 0:t.name))))}]}:r})(d,e),O={customLabel:{title:o.i18n.translate("indexPatternFieldEditor.editor.form.customLabelTitle",{defaultMessage:"Set custom label"}),description:o.i18n.translate("indexPatternFieldEditor.editor.form.customLabelDescription",{defaultMessage:"Create a label to display in place of the field name in Discover, Maps, and Visualize. Useful for shortening a long field name.  Queries and filters use the original field name."})},value:{title:o.i18n.translate("indexPatternFieldEditor.editor.form.valueTitle",{defaultMessage:"Set value"}),description:Object(j.jsx)(c.FormattedMessage,{id:"indexPatternFieldEditor.editor.form.valueDescription",defaultMessage:"Set a value for the field instead of retrieving it from the field with the same name in {source}.",values:{source:Object(j.jsx)(f.EuiCode,null,"_source")}})},format:{title:o.i18n.translate("indexPatternFieldEditor.editor.form.formatTitle",{defaultMessage:"Set format"}),description:o.i18n.translate("indexPatternFieldEditor.editor.form.formatDescription",{defaultMessage:"Set your preferred format for displaying the value. Changing the format can affect the value and prevent highlighting in Discover."})},popularity:{title:o.i18n.translate("indexPatternFieldEditor.editor.form.popularityTitle",{defaultMessage:"Set popularity"}),description:o.i18n.translate("indexPatternFieldEditor.editor.form.popularityDescription",{defaultMessage:"Adjust the popularity to make the field appear higher or lower in the fields list.  By default, Discover orders fields from most selected to least selected."})}},[F]=Object(I.n)({form:b}),y=Object(I.o)({form:b,discard:["__meta__.isCustomLabelVisible","__meta__.isValueVisible","__meta__.isFormatVisible","__meta__.isPopularityVisible"]}),{name:w,type:P,script:S,format:C}=F,{name:L,type:R}=g(),k=null!==(a=Boolean(null==e?void 0:e.name)&&(null==L?void 0:L.isModified))&&void 0!==a&&a,N=null!==(l=Boolean(null==e?void 0:e.type)&&(null==R?void 0:R.isModified))&&void 0!==l&&l,z=Object(T.get)(F,"__meta__.isValueVisible");return Object(r.useEffect)((()=>{t&&t({isValid:x,isSubmitted:h,isSubmitting:_,submit:v})}),[t,x,h,_,v]),Object(r.useEffect)((()=>{p({name:Boolean(null==w?void 0:w.trim())?w:null,type:null==P?void 0:P[0].value,script:!1===z||!1===Boolean(null==S?void 0:S.source.trim())?null:S,format:void 0!==(null==C?void 0:C.id)?C:null})}),[w,P,S,z,C,p]),Object(r.useEffect)((()=>{i&&i(y)}),[y,i]),Object(j.jsx)(I.b,{form:b,className:"indexPatternFieldEditor__form","data-test-subj":"indexPatternFieldEditorForm",isInvalid:h&&!1===x,error:b.getErrors()},Object(j.jsx)(f.EuiFlexGroup,null,Object(j.jsx)(f.EuiFlexItem,null,Object(j.jsx)(I.f,{path:"name",config:E,component:I.d,"data-test-subj":"nameField",componentProps:{euiFieldProps:{disabled:"concrete"===m,"aria-label":o.i18n.translate("indexPatternFieldEditor.editor.form.nameAriaLabel",{defaultMessage:"Name field"})}}})),Object(j.jsx)(f.EuiFlexItem,null,Object(j.jsx)(de,{isDisabled:"concrete"===m}))),(k||N)&&Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(f.EuiSpacer,{size:"xs"}),Object(j.jsx)(f.EuiCallOut,{color:"warning",title:_e,iconType:"alert",size:"s","data-test-subj":"changeWarning"})),Object(j.jsx)(f.EuiSpacer,{size:"xl"}),Object(j.jsx)(he,{title:O.customLabel.title,description:O.customLabel.description,formFieldPath:"__meta__.isCustomLabelVisible","data-test-subj":"customLabelRow",withDividerRule:!0},Object(j.jsx)(ue,null)),"runtime"===m&&Object(j.jsx)(he,{title:O.value.title,description:O.value.description,formFieldPath:"__meta__.isValueVisible","data-test-subj":"valueRow",withDividerRule:!0},Object(j.jsx)(ve,{existingConcreteFields:u,links:s})),Object(j.jsx)(he,{title:O.format.title,description:O.format.description,formFieldPath:"__meta__.isFormatVisible","data-test-subj":"formatRow",withDividerRule:!0},Object(j.jsx)(xe,null)),Object(j.jsx)(ge,null,Object(j.jsx)(he,{title:O.popularity.title,description:O.popularity.description,formFieldPath:"__meta__.isPopularityVisible","data-test-subj":"popularityRow",withDividerRule:!0},Object(j.jsx)(ce,null))))},ye=n.a.memo(Fe);i(20);const we={title:o.i18n.translate("indexPatternFieldEditor.cancelField.confirmationModal.title",{defaultMessage:"Discard changes"}),description:o.i18n.translate("indexPatternFieldEditor.cancelField.confirmationModal.description",{defaultMessage:"Changes that you've made to your field will be discarded, are you sure you want to continue?"}),cancelButton:o.i18n.translate("indexPatternFieldEditor.cancelField.confirmationModal.cancelButtonLabel",{defaultMessage:"Cancel"})},Pe=({onCancel:e,onConfirm:t})=>Object(j.jsx)(f.EuiConfirmModal,{title:we.title,"data-test-subj":"runtimeFieldModifiedFieldConfirmModal",cancelButtonText:we.cancelButton,confirmButtonText:we.title,onCancel:e,onConfirm:t,maxWidth:600},Object(j.jsx)("p",null,we.description)),Se=({fieldName:e,onCancel:t,onConfirm:i})=>{const n=(e=>({cancelButtonText:o.i18n.translate("indexPatternFieldEditor.saveRuntimeField.confirmationModal.cancelButtonLabel",{defaultMessage:"Cancel"}),confirmButtonText:o.i18n.translate("indexPatternFieldEditor.deleteRuntimeField.confirmationModal.saveButtonLabel",{defaultMessage:"Save changes"}),warningChangingFields:o.i18n.translate("indexPatternFieldEditor.deleteRuntimeField.confirmModal.warningChangingFields",{defaultMessage:"Changing name or type can break searches and visualizations that rely on this field."}),typeConfirm:o.i18n.translate("indexPatternFieldEditor.saveRuntimeField.confirmModal.typeConfirm",{defaultMessage:"Enter CHANGE to continue"}),titleConfirmChanges:o.i18n.translate("indexPatternFieldEditor.saveRuntimeField.confirmModal.title",{defaultMessage:"Save changes to '{name}'",values:{name:e}})}))(e),[a,l]=Object(r.useState)("");return Object(j.jsx)(f.EuiConfirmModal,{title:n.titleConfirmChanges,"data-test-subj":"runtimeFieldSaveConfirmModal",cancelButtonText:n.cancelButtonText,confirmButtonText:n.confirmButtonText,confirmButtonDisabled:"CHANGE"!==(null==a?void 0:a.toUpperCase()),onCancel:t,onConfirm:i},Object(j.jsx)(f.EuiCallOut,{color:"warning",title:n.warningChangingFields,iconType:"alert",size:"s"}),Object(j.jsx)(f.EuiSpacer,null),Object(j.jsx)(f.EuiFormRow,{label:n.typeConfirm},Object(j.jsx)(f.EuiFieldText,{value:a,onChange:e=>l(e.target.value),"data-test-subj":"saveModalConfirmText"})))},Ce={cancelButtonLabel:o.i18n.translate("indexPatternFieldEditor.editor.flyoutCancelButtonLabel",{defaultMessage:"Cancel"}),saveButtonLabel:o.i18n.translate("indexPatternFieldEditor.editor.flyoutSaveButtonLabel",{defaultMessage:"Save"})},Me={confirmChangeNameOrType:!1,confirmUnsavedChanges:!1},Te=({field:e,onSave:t,onCancel:i,isSavingField:o,onMounted:a})=>{const s=Object(r.useRef)(!1),d=!!e,{dataView:u}=M(),{panel:{isVisible:m}}=B(),[p,b]=Object(r.useState)({isSubmitted:!1,isSubmitting:!1,isValid:!!e||void 0,submit:e?async()=>({isValid:!0,data:e}):async()=>({isValid:!1,data:{}})}),[v,x]=Object(r.useState)(Me),[h,g]=Object(r.useState)(!1),{submit:_,isValid:E,isSubmitting:S}=p,C=!1===E,T=Object(r.useCallback)((()=>(h&&x({...Me,confirmUnsavedChanges:!0}),!h)),[h]),I=Object(r.useCallback)((async()=>{const{isValid:i,data:r}=await _();if(s.current&&i){const i=(null==e?void 0:e.name)!==r.name,n=(null==e?void 0:e.type)!==r.type;d&&(i||n)?x({...Me,confirmChangeNameOrType:!0}):t(r)}}),[t,_,e,d]),L=Object(r.useCallback)((()=>{T()&&i()}),[i,T]);return Object(r.useEffect)((()=>{if(a)return a({canCloseValidator:T}),()=>{a({canCloseValidator:()=>!0})}}),[a,T]),Object(r.useEffect)((()=>(s.current=!0,()=>{s.current=!1})),[]),Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(O,{flyoutClassName:l.a,maxWidth:1180,"data-test-subj":"fieldEditor",fixedPanelWidths:!0},Object(j.jsx)(F,{width:600},Object(j.jsx)(y,null,Object(j.jsx)(w,null,Object(j.jsx)(f.EuiTitle,{"data-test-subj":"flyoutTitle"},Object(j.jsx)("h2",null,e?Object(j.jsx)(c.FormattedMessage,{id:"indexPatternFieldEditor.editor.flyoutEditFieldTitle",defaultMessage:"Edit field '{fieldName}'",values:{fieldName:e.name}}):Object(j.jsx)(c.FormattedMessage,{id:"indexPatternFieldEditor.editor.flyoutDefaultTitle",defaultMessage:"Create field"}))),Object(j.jsx)(f.EuiText,{color:"subdued"},Object(j.jsx)("p",null,Object(j.jsx)(c.FormattedMessage,{id:"indexPatternFieldEditor.editor.flyoutEditFieldSubtitle",defaultMessage:"Data view: {patternName}",values:{patternName:Object(j.jsx)("i",null,u.title)}})))),Object(j.jsx)(ye,{field:e,onChange:b,onFormModifiedChange:g})),Object(j.jsx)(P,null,Object(j.jsx)(n.a.Fragment,null,Object(j.jsx)(f.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(j.jsx)(f.EuiFlexItem,{grow:!1},Object(j.jsx)(f.EuiButtonEmpty,{iconType:"cross",flush:"left",onClick:L,"data-test-subj":"closeFlyoutButton"},Ce.cancelButtonLabel)),Object(j.jsx)(f.EuiFlexItem,{grow:!1},Object(j.jsx)(f.EuiButton,{color:"primary",onClick:I,"data-test-subj":"fieldSaveButton",fill:!0,disabled:C,isLoading:o||S},Ce.saveButtonLabel)))))),m&&Object(j.jsx)(F,{width:440,backgroundColor:"euiPageBackground",border:"left","data-test-subj":"previewPanel"},Object(j.jsx)(te,null))),v.confirmChangeNameOrType?Object(j.jsx)(Se,{fieldName:null==e?void 0:e.name,onConfirm:async()=>{const{data:e}=await _();t(e)},onCancel:()=>{x(Me)}}):v.confirmUnsavedChanges?Object(j.jsx)(Pe,{onConfirm:()=>{x(Me),i()},onCancel:()=>{x(Me)}}):null)},Ie=n.a.memo(Te),Le=({field:e,onSave:t,onCancel:i,onMounted:n,docLinks:s,fieldTypeToProcess:u,dataView:c,dataViews:f,search:m,notifications:p,usageCollection:b,apiService:v,fieldFormatEditors:x,fieldFormats:h,uiSettings:g})=>{const _=((e,t)=>{var i;if(void 0!==t)return{name:t.name,type:null!=t&&t.esTypes?t.esTypes[0]:"keyword",script:t.runtimeField?t.runtimeField.script:void 0,customLabel:t.customLabel,popularity:t.count,format:null===(i=e.getFormatterForFieldNoDefault(t.name))||void 0===i?void 0:i.toJSON()}})(c,e),[E,O]=Object(r.useState)(!1),{fields:F}=c,y=Object(r.useMemo)((()=>F.map((e=>e.name))),[F]),w=Object(r.useMemo)((()=>{const t=[];return F.filter((t=>!((null==e?void 0:e.name)===t.name)&&t.isMapped)).forEach((e=>{t.push({name:e.name,type:e.esTypes&&e.esTypes[0]||""})})),t}),[F,e]),P=Object(r.useMemo)((()=>({api:v,search:m,notifications:p})),[v,m,p]),S=Object(r.useCallback)((async i=>{O(!0);const{script:r}=i;if("runtime"===u){try{b.reportUiCounter(l.b,a.METRIC_TYPE.COUNT,"save_runtime")}catch{}null!=e&&e.name&&e.name!==i.name&&c.removeRuntimeField(e.name),c.addRuntimeField(i.name,{type:i.type,script:r})}else try{b.reportUiCounter(l.b,a.METRIC_TYPE.COUNT,"save_concrete")}catch{}const n=c.getFieldByName(i.name);try{if(!n)throw new Error(`Unable to find field named '${i.name}' on index pattern '${c.title}'`);c.setFieldCustomLabel(i.name,i.customLabel),n.count=i.popularity||0,i.format?c.setFieldFormat(i.name,i.format):c.deleteFieldFormat(i.name),await f.updateSavedObject(c).then((()=>{const e=o.i18n.translate("indexPatternFieldEditor.deleteField.savedHeader",{defaultMessage:"Saved '{fieldName}'",values:{fieldName:i.name}});p.toasts.addSuccess(e),O(!1),t(n)}))}catch(e){const t=o.i18n.translate("indexPatternFieldEditor.save.errorTitle",{defaultMessage:"Failed to save field changes"});p.toasts.addError(e,{title:t}),O(!1)}}),[t,c,f,p,u,null==e?void 0:e.name,b]);return Object(j.jsx)(C,{dataView:c,uiSettings:g,links:d(s),fieldTypeToProcess:u,services:P,fieldFormatEditors:x,fieldFormats:h,namesNotAllowed:y,existingConcreteFields:w},Object(j.jsx)(V,null,Object(j.jsx)(Ie,{onSave:S,onCancel:i,onMounted:n,field:_,isSavingField:E})))}}}]);