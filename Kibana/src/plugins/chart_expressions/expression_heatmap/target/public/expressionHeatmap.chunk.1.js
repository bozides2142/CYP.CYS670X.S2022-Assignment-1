(window.expressionHeatmap_bundle_jsonpfunction=window.expressionHeatmap_bundle_jsonpfunction||[]).push([[1],{19:function(e,n,t){"use strict";var o,i=function(){return void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o},l=function(){var e={};return function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}e[n]=t}return e[n]}}(),r=[];function a(e){for(var n=-1,t=0;t<r.length;t++)if(r[t].identifier===e){n=t;break}return n}function s(e,n){for(var t={},o=[],i=0;i<e.length;i++){var l=e[i],s=n.base?l[0]+n.base:l[0],c=t[s]||0,u="".concat(s," ").concat(c);t[s]=c+1;var d=a(u),m={css:l[1],media:l[2],sourceMap:l[3]};-1!==d?(r[d].references++,r[d].updater(m)):r.push({identifier:u,updater:f(m,n),references:1}),o.push(u)}return o}function c(e){var n=document.createElement("style"),o=e.attributes||{};if(void 0===o.nonce){var i=t.nc;i&&(o.nonce=i)}if(Object.keys(o).forEach((function(e){n.setAttribute(e,o[e])})),"function"==typeof e.insert)e.insert(n);else{var r=l(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}return n}var u,d=(u=[],function(e,n){return u[e]=n,u.filter(Boolean).join("\n")});function m(e,n,t,o){var i=t?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(e.styleSheet)e.styleSheet.cssText=d(n,i);else{var l=document.createTextNode(i),r=e.childNodes;r[n]&&e.removeChild(r[n]),r.length?e.insertBefore(l,r[n]):e.appendChild(l)}}function v(e,n,t){var o=t.css,i=t.media,l=t.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),l&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(l))))," */")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}var p=null,g=0;function f(e,n){var t,o,i;if(n.singleton){var l=g++;t=p||(p=c(n)),o=m.bind(null,t,l,!1),i=m.bind(null,t,l,!0)}else t=c(n),o=v.bind(null,t,n),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)};return o(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;o(e=n)}else i()}}e.exports=function(e,n){(n=n||{}).singleton||"boolean"==typeof n.singleton||(n.singleton=i());var t=s(e=e||[],n);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var o=0;o<t.length;o++){var i=a(t[o]);r[i].references--}for(var l=s(e,n),c=0;c<t.length;c++){var u=a(t[c]);0===r[u].references&&(r[u].updater(),r.splice(u,1))}t=l}}}},20:function(e,n,t){"use strict";e.exports=function(e){var n=[];return n.toString=function(){return this.map((function(n){var t=function(e,n){var t=e[1]||"",o=e[3];if(!o)return t;if(n&&"function"==typeof btoa){var i=(r=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(s," */")),l=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[t].concat(l).concat([i]).join("\n")}var r,a,s;return[t].join("\n")}(n,e);return n[2]?"@media ".concat(n[2]," {").concat(t,"}"):t})).join("")},n.i=function(e,t,o){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(o)for(var l=0;l<this.length;l++){var r=this[l][0];null!=r&&(i[r]=!0)}for(var a=0;a<e.length;a++){var s=[].concat(e[a]);o&&i[s[0]]||(t&&(s[2]?s[2]="".concat(t," and ").concat(s[2]):s[2]=t),n.push(s))}},n}},21:function(e,n,t){switch(window.__kbnThemeTag__){case"v8dark":return t(22);case"v8light":return t(24)}},22:function(e,n,t){var o=t(19),i=t(23);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};o(i,l);e.exports=i.locals||{}},23:function(e,n,t){(n=t(20)(!1)).push([e.i,".heatmap-container{scrollbar-color:rgba(152,162,179,0.5) rgba(0,0,0,0);scrollbar-width:thin;height:100%;width:100%;overflow:auto hidden;-webkit-user-select:text;user-select:text;padding:8px}.heatmap-container::-webkit-scrollbar{width:16px;height:16px}.heatmap-container::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.heatmap-container::-webkit-scrollbar-corner,.heatmap-container::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}\n",""]),e.exports=n},24:function(e,n,t){var o=t(19),i=t(25);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var l={insert:"head",singleton:!1};o(i,l);e.exports=i.locals||{}},25:function(e,n,t){(n=t(20)(!1)).push([e.i,".heatmap-container{scrollbar-color:rgba(105,112,125,0.5) rgba(0,0,0,0);scrollbar-width:thin;height:100%;width:100%;overflow:auto hidden;-webkit-user-select:text;user-select:text;padding:8px}.heatmap-container::-webkit-scrollbar{width:16px;height:16px}.heatmap-container::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.heatmap-container::-webkit-scrollbar-corner,.heatmap-container::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}\n",""]),e.exports=n},26:function(e,n,t){"use strict";t.r(n),t.d(n,"HeatmapComponent",(function(){return T})),t.d(n,"default",(function(){return T}));var o=t(8),i=t.n(o),l=t(4),r=t(17),a=t(16);const s="temperature",c=s,u="percent",d=0,m=100,v=5;function p(e,n){const t=e.map(((e,t,o)=>({...e,stop:t+1<o.length?o[t+1].stop:n})));if(e[e.length-1].stop===n){const o=function(e,n,t){const o=n.length,i=n[o-1].stop-n[o-2].stop||1;let l=Number(i.toFixed(2));if(t<e[o-1].stop+l){const n=t-e[o-1].stop;l=n>0?n:1}return l}(e,t,n)||1,i=Math.min(1,o);t[e.length-1].stop=n+i}return t}function g(e,n){var t,o,i,l,r,a;const{min:s,max:c}=function(e,n){const t="number"===e?n.min:0,o="number"===e?n.max:100;return{min:t,max:o}}(null==e?void 0:e.rangeType,n),u=null!==(t=null==e||null===(o=e.colorStops)||void 0===o||null===(i=o[0])||void 0===i?void 0:i.stop)&&void 0!==t?t:1/0,d=null!==(l=null==e||null===(r=e.colorStops)||void 0===r||null===(a=r[e.colorStops.length-1])||void 0===a?void 0:a.stop)&&void 0!==l?l:-1/0;return{min:Math.min(s,u),max:Math.max(c,d)}}function f(e,n,t){var o,i;let l=function(e,n,{prevPalette:t,dataBounds:o,mapFromMinValue:i,defaultPaletteName:l}){const{min:r,max:a}=g(n,o),s=a-r,{stops:u,...d}=n||{};if("custom"===n.name&&null!=n&&n.colorStops)return p(n.colorStops,a);const m=e.get(t||(null==n?void 0:n.name)||l||c).getCategoricalColors(v,d),f=i?r:s/v;return function(e,{newInterval:n,oldInterval:t,newMin:o,oldMin:i}){return(e||[]).map((({color:e,stop:l})=>({color:e,stop:o+(l-i)*n/t})))}(m.map(((e,n)=>({color:e,stop:n}))),{newInterval:s,oldInterval:m.length,newMin:f,oldMin:0})}(e,(null==n?void 0:n.params)||{},{dataBounds:t,defaultPaletteName:null==n?void 0:n.name});return null!=n&&null!==(o=n.params)&&void 0!==o&&o.reverse&&"custom"!==(null==n||null===(i=n.params)||void 0===i?void 0:i.name)&&(l=function(e=[]){const n=e.map((({stop:e})=>e));return e.map((({color:t},o)=>({color:t,stop:n[e.length-o-1]}))).reverse()}(l)),l}function b(e){return e}function h(e){if(null!=e&&!Array.isArray(e))return e}const x=e=>{var n,t;const o=null===(n=e.meta)||void 0===n||null===(t=n.sourceParams)||void 0===t?void 0:t.params,i=null==o?void 0:o.orderBy;return null!=o&&o.otherBucket||!i?"dataIndex":i&&"_key"!==i?"desc"===(null==o?void 0:o.order)?"numDesc":"numAsc":"desc"===(null==o?void 0:o.order)?"alphaDesc":"alphaAsc"};var w=t(18),y=t(1);function C(e){switch(e){case l.Position.Bottom:return"upCenter";case l.Position.Top:return"downCenter";case l.Position.Left:return"rightCenter";default:return"leftCenter"}}var k=t(9);t(21);function j({colors:e,stops:n,range:t},{min:o,max:i}){if(n.length)return n.slice(0,n.length-1);const l="percent"===t?0:o,r=(("percent"===t?100:i)-l)/e.length;return e.slice(0,e.length-1).map(((e,n)=>l+(n+1)*r))}function S(e,n,t,o){const i=(null==n?void 0:n.colors)||f(e,{type:"palette",name:s},o).map((({color:e})=>e)),l=[i[0],...i],r=function(e,{min:n,max:t}){const o="percent"===e.range?0:n;return[e.stops.length?e.rangeMin:o,...j(e,{min:n,max:t})].map((o=>{let i=o;return"percent"===e.range&&(i=n+(t-n)*o/100),Number.isNaN(i)?1:Number(i.toFixed(2))}))}({gradient:!1,range:u,rangeMin:d,rangeMax:m,stops:[],...n,colors:l.slice(1)},o);return{colors:l,ranges:r}}const I=(e,n)=>{if("string"==typeof e)return e;const t=e.accessor;return"number"==typeof t?n[t].id:t.id},T=Object(o.memo)((({data:e,args:n,timeZone:t,formatFactory:s,chartsThemeService:c,onClickValue:u,onSelectRange:d,paletteService:m,uiState:v,interactive:p})=>{var g,f,j,T,A,O,M,N,L,F,P,E,_,D,V,R,B,H,Y,z,$,U,W,X,J,Z;const q=c.useChartsTheme(),G=c.useDarkMode(),[K,Q]=Object(o.useState)((()=>{var e;const t=null===(e=n.legend.isVisible)||void 0===e||e;return null==v?void 0:v.get("vis.legendOpen",t)})),ee=Object(o.useCallback)((()=>{p&&Q((e=>{var n;const t=!e;return null==v||null===(n=v.set)||void 0===n||n.call(v,"vis.legendOpen",t),t}))}),[v,p]),ne=Object(o.useCallback)(((e,n)=>{const t=(null==v?void 0:v.get("vis.colors"))||{};t[n]!==e&&e?t[n]=e:delete t[n],null==v||v.setSilent("vis.colors",null),null==v||v.set("vis.colors",t),null==v||v.emit("reload"),null==v||v.emit("colorChanged")}),[v]),te=Object(o.useMemo)((()=>((e,n,t)=>({anchor:i,color:l,onClose:r,onChange:s,seriesIdentifiers:[c]})=>{var u;const d=c.key,m=null!==(u=null==t?void 0:t.get("vis.colors",{}))&&void 0!==u?u:{},v=d.toString()in m;let p=!1;const g=Object(o.useCallback)((()=>{null==r||r()}),[r]);return Object(y.jsx)(w.EuiOutsideClickDetector,{onOutsideClick:g},Object(y.jsx)(w.EuiPopover,{isOpen:!0,ownFocus:!0,display:"block",button:i,anchorPosition:C(e),closePopover:r,panelPaddingSize:"s"},Object(y.jsx)(a.ColorPicker,{color:l,onChange:e=>{e&&s(e),n(e,d),e&&p||r()},label:d,useLegacyColors:!1,colorIsOverwritten:v,onKeyDown:e=>{13===e.keyCode&&(null==r||r()),p=!0}})))})(n.legend.position,ne,v)),[n.legend.position,ne,v]),oe=e,ie=n.valueAccessor?I(n.valueAccessor,oe.columns):void 0,le=Object(o.useMemo)((()=>((e,n,t=b)=>{const o={};if(null!=n)for(const i of e){const e=t(i);o[e]=o[e]||{max:-1/0,min:1/0},n.rows.forEach((n=>{const t=h(n[i]);null!=t&&(o[e].min>t&&(o[e].min=t),o[e].max<t&&(o[e].max=t))})),o[e].max===-1/0&&(o[e]={max:100,min:0,fallback:!0})}return o})([ie],oe)),[ie,oe]),re=null===(g=n.palette)||void 0===g?void 0:g.params,ae=n.xAccessor?I(n.xAccessor,oe.columns):void 0,se=n.yAccessor?I(n.yAccessor,oe.columns):void 0,ce=oe.columns.findIndex((e=>e.id===ae)),ue=oe.columns.findIndex((e=>e.id===se)),de=oe.columns[ce],me=oe.columns[ue],ve=oe.columns.find((e=>e.id===ie)),pe=null==de?void 0:de.meta,ge="date"===(null==pe?void 0:pe.type),fe=Object(o.useCallback)((e=>{var n;const t=e[0][0],{x:o,y:i}=t.datum,l=null==de||null===(n=de.meta)||void 0===n?void 0:n.field,r=ge?l:"",a={data:[{row:oe.rows.findIndex((e=>e[de.id]===o)),column:ce,value:o},...me?[{row:oe.rows.findIndex((e=>e[me.id]===i)),column:ue,value:i}]:[]].map((e=>({row:e.row,column:e.column,value:e.value,table:oe}))),timeFieldName:r};u(a)}),[ge,u,oe,null==de?void 0:de.id,null==de||null===(f=de.meta)||void 0===f?void 0:f.field,ce,me,ue]),be=Object(o.useCallback)((e=>{var n;const{x:t,y:o}=e,i=null==de||null===(n=de.meta)||void 0===n?void 0:n.field,l=ge?i:"";if(ge){d({range:t,table:oe,column:ce,timeFieldName:l})}else{const e=[];me&&o.forEach((n=>{e.push({row:oe.rows.findIndex((e=>e[me.id]===n)),column:ue,value:n})})),de&&t.forEach((n=>{e.push({row:oe.rows.findIndex((e=>e[de.id]===n)),column:ce,value:n})}));const n={data:e.map((e=>({row:e.row,column:e.column,value:e.value,table:oe}))),timeFieldName:l};u(n)}}),[ge,u,d,oe,de,ce,me,ue]);if(!ve)return null;let he=oe.rows.filter((e=>"number"==typeof e[ie]));if(!he||!he.length)return Object(y.jsx)(a.EmptyPlaceholder,{icon:k.a});me||(he=he.map((e=>({...e,unifiedY:""}))));const{min:xe,max:we}=le[ie],ye=s(null==pe?void 0:pe.params),Ce=s("string"==typeof n.valueAccessor?ve.meta.params:null==n||null===(j=n.valueAccessor)||void 0===j?void 0:j.format),ke=de?r.search.aggs.getDateHistogramMetaDataByDatatableColumn(de):void 0;let je={type:l.ScaleType.Ordinal};if(ge&&he.length>1){const e=null==ke?void 0:ke.interval,n=e?r.search.aggs.parseEsInterval(e):void 0;n&&(je={type:l.ScaleType.Time,interval:"fixed"===n.type?{type:"fixed",unit:n.unit,value:n.value}:{type:"calendar",unit:n.unit,value:n.value}})}const Se={type:n.showTooltip?l.TooltipType.Follow:l.TooltipType.None},{colors:Ie,ranges:Te}=S(m,re,0,le[ie]),Ae=1e-5;let Oe=we+Ae;(null!=re&&re.rangeMax||0===(null==re?void 0:re.rangeMax))&&(Oe=("number"===(null==re?void 0:re.range)?re.rangeMax:xe+(we-xe)*re.rangeMax/100)+Ae);const Me=null!==(T=null==v?void 0:v.get("vis.colors"))&&void 0!==T?T:null,Ne=we===xe,Le=Te.map(((e,t,o)=>{const i=t===o.length-1,l=o[t+1];let r=i?Number.POSITIVE_INFINITY:l;const a=i&&Ne?xe:e;if(!1===n.lastRangeIsRightOpen){const e=Ne?Number.POSITIVE_INFINITY:Oe;r=i?e:l}let s;s=r===Number.POSITIVE_INFINITY?`â‰¥ ${Ce.convert(a)}`:`${Ce.convert(e)} - ${Ce.convert(r)}`;const c=null==Me?void 0:Me[s];return{start:a,end:r,color:null!=c?c:Ie[t+1]}})),Fe={legend:{labelOptions:{maxLines:n.legend.shouldTruncate?null!==(A=null===(O=n.legend)||void 0===O?void 0:O.maxLines)&&void 0!==A?A:1:0}},heatmap:{grid:{stroke:{width:null!==(M=null!==(N=n.gridConfig.strokeWidth)&&void 0!==N?N:null===(L=q.axes)||void 0===L||null===(F=L.gridLine)||void 0===F||null===(P=F.horizontal)||void 0===P?void 0:P.strokeWidth)&&void 0!==M?M:1,color:null!==(E=null!==(_=n.gridConfig.strokeColor)&&void 0!==_?_:null===(D=q.axes)||void 0===D||null===(V=D.gridLine)||void 0===V||null===(R=V.horizontal)||void 0===R?void 0:R.stroke)&&void 0!==E?E:"#D3DAE6"},cellHeight:{max:"fill",min:1}},cell:{maxWidth:"fill",maxHeight:"fill",label:{visible:null!==(B=n.gridConfig.isCellLabelVisible)&&void 0!==B&&B,minFontSize:8,maxFontSize:18,useGlobalMinFontSize:!0},border:{strokeWidth:0}},yAxisLabel:{visible:!!me&&n.gridConfig.isYAxisLabelVisible,textColor:null!==(H=null===(Y=q.axes)||void 0===Y||null===(z=Y.tickLabel)||void 0===z?void 0:z.fill)&&void 0!==H?H:"#6a717d",padding:null!=me&&me.name?8:0},xAxisLabel:{visible:Boolean(n.gridConfig.isXAxisLabelVisible&&de),textColor:null!==($=null===(U=q.axes)||void 0===U||null===(W=U.tickLabel)||void 0===W?void 0:W.fill)&&void 0!==$?$:"#6a717d",padding:null!=de&&de.name?8:0},brushMask:{fill:G?"rgb(30,31,35,80%)":"rgb(247,247,247,50%)"},brushArea:{stroke:G?"rgb(255, 255, 255)":"rgb(105, 112, 125)"}}},Pe=null!==(X=n.gridConfig.xTitle)&&void 0!==X?X:null==de?void 0:de.name,Ee=null!==(J=n.gridConfig.yTitle)&&void 0!==J?J:null==me?void 0:me.name;return Object(y.jsx)(i.a.Fragment,null,void 0!==K&&Object(y.jsx)(a.LegendToggle,{onClick:ee,showLegend:K,legendPosition:n.legend.position}),Object(y.jsx)(l.Chart,null,Object(y.jsx)(l.Settings,{onElementClick:p?fe:void 0,showLegend:null!=K?K:n.legend.isVisible,legendPosition:n.legend.position,legendColorPicker:v?te:void 0,debugState:null!==(Z=window._echDebugStateFlag)&&void 0!==Z&&Z,tooltip:Se,theme:[Fe,q],xDomain:{min:ke&&ke.timeRange?new Date(ke.timeRange.from).getTime():NaN,max:ke&&ke.timeRange?new Date(ke.timeRange.to).getTime():NaN},onBrushEnd:p?be:void 0}),Object(y.jsx)(l.Heatmap,{id:"heatmap",name:ve.name,colorScale:{type:"bands",bands:Le},timeZone:t,data:he,xAccessor:ae,yAccessor:se||"unifiedY",valueAccessor:ie,valueFormatter:e=>{var t;let o=e;if(n.percentageMode){const e=Math.abs(o-xe)/(we-xe)*100;o=parseInt(e.toString(),10)/100}return`${null!==(t=Ce.convert(o))&&void 0!==t?t:""}`},xScale:je,ySortPredicate:me?x(me):"dataIndex",xSortPredicate:de?x(de):"dataIndex",xAxisLabelName:null==de?void 0:de.name,yAxisLabelName:null==me?void 0:me.name,xAxisTitle:n.gridConfig.isXAxisTitleVisible?Pe:void 0,yAxisTitle:n.gridConfig.isYAxisTitleVisible?Ee:void 0,xAxisLabelFormatter:e=>n.gridConfig.isXAxisLabelVisible?`${ye.convert(e)}`:"",yAxisLabelFormatter:me?e=>{var t;return n.gridConfig.isYAxisLabelVisible?`${null!==(t=s(me.meta.params).convert(e))&&void 0!==t?t:""}`:""}:void 0})))}))}}]);