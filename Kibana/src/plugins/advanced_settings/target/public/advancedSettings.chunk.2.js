(window.advancedSettings_bundle_jsonpfunction=window.advancedSettings_bundle_jsonpfunction||[]).push([[2],{21:function(e,t,n){"use strict";var s,a=function(){return void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s},i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),r=[];function o(e){for(var t=-1,n=0;n<r.length;n++)if(r[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},s=[],a=0;a<e.length;a++){var i=e[a],c=t.base?i[0]+t.base:i[0],d=n[c]||0,u="".concat(c," ").concat(d);n[c]=d+1;var l=o(u),g={css:i[1],media:i[2],sourceMap:i[3]};-1!==l?(r[l].references++,r[l].updater(g)):r.push({identifier:u,updater:f(g,t),references:1}),s.push(u)}return s}function d(e){var t=document.createElement("style"),s=e.attributes||{};if(void 0===s.nonce){var a=n.nc;a&&(s.nonce=a)}if(Object.keys(s).forEach((function(e){t.setAttribute(e,s[e])})),"function"==typeof e.insert)e.insert(t);else{var r=i(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var u,l=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function g(e,t,n,s){var a=n?"":s.media?"@media ".concat(s.media," {").concat(s.css,"}"):s.css;if(e.styleSheet)e.styleSheet.cssText=l(t,a);else{var i=document.createTextNode(a),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(i,r[t]):e.appendChild(i)}}function h(e,t,n){var s=n.css,a=n.media,i=n.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=s;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(s))}}var p=null,m=0;function f(e,t){var n,s,a;if(t.singleton){var i=m++;n=p||(p=d(t)),s=g.bind(null,n,i,!1),a=g.bind(null,n,i,!0)}else n=d(t),s=h.bind(null,n,t),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return s(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;s(e=t)}else a()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=a());var n=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var s=0;s<n.length;s++){var a=o(n[s]);r[a].references--}for(var i=c(e,t),d=0;d<n.length;d++){var u=o(n[d]);0===r[u].references&&(r[u].updater(),r.splice(u,1))}n=i}}}},22:function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",s=e[3];if(!s)return n;if(t&&"function"==typeof btoa){var a=(r=s,o=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(c," */")),i=s.sources.map((function(e){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(e," */")}));return[n].concat(i).concat([a]).join("\n")}var r,o,c;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,s){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(s)for(var i=0;i<this.length;i++){var r=this[i][0];null!=r&&(a[r]=!0)}for(var o=0;o<e.length;o++){var c=[].concat(e[o]);s&&a[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},23:function(e,t,n){"use strict";const s=n(24),a=n(25),i=n(26);function r(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function o(e,t){return t.encode?t.strict?s(e):encodeURIComponent(e):e}function c(e,t){return t.decode?a(e):e}function d(e){return Array.isArray(e)?e.sort():"object"==typeof e?d(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function u(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function l(e){const t=(e=u(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function g(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function h(e,t){r((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,s)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===s[e]&&(s[e]={}),s[e][t[1]]=n):s[e]=n};case"bracket":return(e,n,s)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==s[e]?s[e]=[].concat(s[e],n):s[e]=[n]:s[e]=n};case"comma":case"separator":return(t,n,s)=>{const a="string"==typeof n&&n.split("").indexOf(e.arrayFormatSeparator)>-1?n.split(e.arrayFormatSeparator).map((t=>c(t,e))):null===n?n:c(n,e);s[t]=a};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),s=Object.create(null);if("string"!=typeof e)return s;if(!(e=e.trim().replace(/^[?#&]/,"")))return s;for(const a of e.split("&")){let[e,r]=i(t.decode?a.replace(/\+/g," "):a,"=");r=void 0===r?null:["comma","separator"].includes(t.arrayFormat)?r:c(r,t),n(c(e,t),r,s)}for(const e of Object.keys(s)){const n=s[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=g(n[e],t);else s[e]=g(n,t)}return!1===t.sort?s:(!0===t.sort?Object.keys(s).sort():Object.keys(s).sort(t.sort)).reduce(((e,t)=>{const n=s[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=d(n):e[t]=n,e}),Object.create(null))}t.extract=l,t.parse=h,t.stringify=(e,t)=>{if(!e)return"";r((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],s=function(e){switch(e.arrayFormat){case"index":return t=>(n,s)=>{const a=n.length;return void 0===s||e.skipNull&&null===s||e.skipEmptyString&&""===s?n:null===s?[...n,[o(t,e),"[",a,"]"].join("")]:[...n,[o(t,e),"[",o(a,e),"]=",o(s,e)].join("")]};case"bracket":return t=>(n,s)=>void 0===s||e.skipNull&&null===s||e.skipEmptyString&&""===s?n:null===s?[...n,[o(t,e),"[]"].join("")]:[...n,[o(t,e),"[]=",o(s,e)].join("")];case"comma":case"separator":return t=>(n,s)=>null==s||0===s.length?n:0===n.length?[[o(t,e),"=",o(s,e)].join("")]:[[n,o(s,e)].join(e.arrayFormatSeparator)];default:return t=>(n,s)=>void 0===s||e.skipNull&&null===s||e.skipEmptyString&&""===s?n:null===s?[...n,o(t,e)]:[...n,[o(t,e),"=",o(s,e)].join("")]}}(t),a={};for(const t of Object.keys(e))n(t)||(a[t]=e[t]);const i=Object.keys(a);return!1!==t.sort&&i.sort(t.sort),i.map((n=>{const a=e[n];return void 0===a?"":null===a?o(n,t):Array.isArray(a)?a.reduce(s(n),[]).join("&"):o(n,t)+"="+o(a,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,s]=i(e,"#");return Object.assign({url:n.split("?")[0]||"",query:h(l(e),t)},t&&t.parseFragmentIdentifier&&s?{fragmentIdentifier:c(s,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const s=u(e.url).split("?")[0]||"",a=t.extract(e.url),i=t.parse(a,{sort:!1}),r=Object.assign(i,e.query);let c=t.stringify(r,n);c&&(c=`?${c}`);let d=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(d=`#${o(e.fragmentIdentifier,n)}`),`${s}${c}${d}`}},24:function(e,t,n){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},25:function(e,t,n){"use strict";var s="%[a-f0-9]{2}",a=new RegExp(s,"gi"),i=new RegExp("("+s+")+","gi");function r(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),s=e.slice(t);return Array.prototype.concat.call([],r(n),r(s))}function o(e){try{return decodeURIComponent(e)}catch(s){for(var t=e.match(a),n=1;n<t.length;n++)t=(e=r(t,n).join("")).match(a);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=i.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var s=o(n[0]);s!==n[0]&&(t[n[0]]=s)}n=i.exec(e)}t["%C2"]="�";for(var a=Object.keys(t),r=0;r<a.length;r++){var c=a[r];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},26:function(e,t,n){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}},27:function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(28);case"v8light":return n(30)}},28:function(e,t,n){var s=n(21),a=n(29);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var i={insert:"head",singleton:!1};s(a,i);e.exports=a.locals||{}},29:function(e,t,n){(t=n(22)(!1)).push([e.i,".mgtAdvancedSettings__field+*{margin-top:16px}.mgtAdvancedSettings__field .mgtAdvancedSettings__fieldTitle{padding-left:8px;margin-left:-8px}.mgtAdvancedSettings__field--unsaved .mgtAdvancedSettings__fieldTitle{box-shadow:-4px 0 #F3D371}.mgtAdvancedSettings__field--invalid .mgtAdvancedSettings__fieldTitle{box-shadow:-4px 0 #F86B63}@media screen and (-ms-high-contrast: active), screen and (-ms-high-contrast: none){.mgtAdvancedSettings__field{min-height:1px}.mgtAdvancedSettings__fieldRow{min-height:1px}}.mgtAdvancedSettings__fieldTitleUnsavedIcon{margin-left:8px}@media only screen and (max-width: 574px){.mgtAdvancedSettingsForm__unsavedCount{display:none}}.mgtAdvancedSettingsForm__unsavedCountMessage{box-shadow:-4px 0 #F3D371;padding-left:8px}.mgtAdvancedSettingsForm__button{width:100%}.kbnBody--mgtAdvancedSettingsHasBottomBar .mgtPage__body{padding-bottom:64px}\n",""]),e.exports=t},30:function(e,t,n){var s=n(21),a=n(31);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var i={insert:"head",singleton:!1};s(a,i);e.exports=a.locals||{}},31:function(e,t,n){(t=n(22)(!1)).push([e.i,".mgtAdvancedSettings__field+*{margin-top:16px}.mgtAdvancedSettings__field .mgtAdvancedSettings__fieldTitle{padding-left:8px;margin-left:-8px}.mgtAdvancedSettings__field--unsaved .mgtAdvancedSettings__fieldTitle{box-shadow:-4px 0 #FEC514}.mgtAdvancedSettings__field--invalid .mgtAdvancedSettings__fieldTitle{box-shadow:-4px 0 #BD271E}@media screen and (-ms-high-contrast: active), screen and (-ms-high-contrast: none){.mgtAdvancedSettings__field{min-height:1px}.mgtAdvancedSettings__fieldRow{min-height:1px}}.mgtAdvancedSettings__fieldTitleUnsavedIcon{margin-left:8px}@media only screen and (max-width: 574px){.mgtAdvancedSettingsForm__unsavedCount{display:none}}.mgtAdvancedSettingsForm__unsavedCountMessage{box-shadow:-4px 0 #FEC514;padding-left:8px}.mgtAdvancedSettingsForm__button{width:100%}.kbnBody--mgtAdvancedSettingsHasBottomBar .mgtPage__body{padding-bottom:64px}\n",""]),e.exports=t},33:function(e,t,n){"use strict";n.r(t),n.d(t,"mountManagementSection",(function(){return w}));var s=n(2),a=n.n(s),i=n(16),r=n.n(i),o=n(17),c=n(3),d=n(5),u=n(11),l=n(13),g=n(0),h=n.n(g),p=n(23),m=n(4),f=n(1);const v=()=>Object(f.jsx)("div",null,Object(f.jsx)(m.EuiCallOut,{title:Object(f.jsx)(d.FormattedMessage,{id:"advancedSettings.callOutCautionTitle",defaultMessage:"Caution: You can break stuff here"}),color:"warning",iconType:"bolt"},Object(f.jsx)("p",null,Object(f.jsx)(d.FormattedMessage,{id:"advancedSettings.callOutCautionDescription",defaultMessage:"Be careful in here, these settings are for very advanced users only. Tweaks you make here can break large portions of Kibana. Some of these settings may be undocumented, unsupported or in technical preview. If a field has a default value, blanking the field will reset it to its default which may be unacceptable given other configuration directives. Deleting a custom setting will permanently remove it from Kibana's config."}))));var b=n(18),y=n(12),j=n(19),x=n(32);class form_Form extends s.PureComponent{constructor(...e){super(...e),h()(this,"state",{unsavedChanges:{},loading:!1}),h()(this,"getSettingByKey",(e=>Object.values(this.props.settings).flat().find((t=>t.name===e)))),h()(this,"getCountOfUnsavedChanges",(()=>Object.keys(this.state.unsavedChanges).length)),h()(this,"getCountOfHiddenUnsavedChanges",(()=>{const e=Object.values(this.props.visibleSettings).flat().map((e=>e.name));return Object.keys(this.state.unsavedChanges).filter((t=>!e.includes(t))).length})),h()(this,"areChangesInvalid",(()=>{const{unsavedChanges:e}=this.state;return Object.values(e).some((({isInvalid:e})=>e))})),h()(this,"handleChange",((e,t)=>{const n=this.getSettingByKey(e);if(!n)return;const{type:s,defVal:a,value:i}=n,r=Object(x.getEditableValue)(s,i,a);if(t.value===r)return this.clearChange(e);this.setState({unsavedChanges:{...this.state.unsavedChanges,[e]:t}})})),h()(this,"clearChange",(e=>{if(!this.state.unsavedChanges[e])return;const t={...this.state.unsavedChanges};delete t[e],this.setState({unsavedChanges:t})})),h()(this,"clearAllUnsaved",(()=>{this.setState({unsavedChanges:{}})})),h()(this,"saveAll",(async()=>{this.setLoading(!0);const{unsavedChanges:e}=this.state;if(Object(y.isEmpty)(e))return;const t={};let n=!1;Object.entries(e).forEach((([e,{value:s}])=>{const a=this.getSettingByKey(e);if(!a)return;const{defVal:i,type:r,requiresPageReload:o,metric:c}=a;let d=s,u=!1;switch(r){case"array":d=d.trim(),d=""===d?[]:d.split(",").map((e=>e.trim())),u=d.join(",")===i.join(",");break;case"json":const e=Array.isArray(JSON.parse(i||"{}"));d=d.trim(),d=d||(e?"[]":"{}");case"boolean":if(c&&this.props.trackUiMetric){const e=d?`${c.name}_on`:`${c.name}_off`;this.props.trackUiMetric(c.type,e)}default:u=d===i}o&&(n=!0),t[e]=u?null:d}));try{await this.props.save(t),this.clearAllUnsaved(),n&&this.renderPageReloadToast()}catch(e){this.props.toasts.addDanger(c.i18n.translate("advancedSettings.form.saveErrorMessage",{defaultMessage:"Unable to save"}))}this.setLoading(!1)})),h()(this,"renderPageReloadToast",(()=>{this.props.toasts.add({title:c.i18n.translate("advancedSettings.form.requiresPageReloadToastDescription",{defaultMessage:"One or more settings require you to reload the page to take effect."}),text:Object(u.toMountPoint)(Object(f.jsx)(u.KibanaThemeProvider,{theme$:this.props.theme},Object(f.jsx)(m.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},Object(f.jsx)(m.EuiFlexItem,{grow:!1},Object(f.jsx)(m.EuiButton,{size:"s",onClick:()=>window.location.reload()},c.i18n.translate("advancedSettings.form.requiresPageReloadToastButtonLabel",{defaultMessage:"Reload page"})))))),color:"success"})})),h()(this,"renderCountOfUnsaved",(()=>{const e=this.getCountOfUnsavedChanges(),t=this.getCountOfHiddenUnsavedChanges();return Object(f.jsx)(m.EuiTextColor,{className:"mgtAdvancedSettingsForm__unsavedCountMessage",color:"ghost"},Object(f.jsx)(d.FormattedMessage,{id:"advancedSettings.form.countOfSettingsChanged",defaultMessage:"{unsavedCount} unsaved {unsavedCount, plural, one {setting} other {settings} }{hiddenCount, plural, =0 {} other {, # hidden} }",values:{unsavedCount:e,hiddenCount:t}}))})),h()(this,"renderBottomBar",(()=>{const e=this.areChangesInvalid();return Object(f.jsx)(m.EuiBottomBar,{"data-test-subj":"advancedSetting-bottomBar"},Object(f.jsx)(m.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",responsive:!1,gutterSize:"s"},Object(f.jsx)(m.EuiFlexItem,{grow:!1,className:"mgtAdvancedSettingsForm__unsavedCount"},Object(f.jsx)("p",{id:"aria-describedby.countOfUnsavedSettings"},this.renderCountOfUnsaved())),Object(f.jsx)(m.EuiFlexItem,null),Object(f.jsx)(m.EuiFlexItem,{grow:!1},Object(f.jsx)(m.EuiButtonEmpty,{color:"ghost",size:"s",iconType:"cross",onClick:this.clearAllUnsaved,"aria-describedby":"aria-describedby.countOfUnsavedSettings","data-test-subj":"advancedSetting-cancelButton"},c.i18n.translate("advancedSettings.form.cancelButtonLabel",{defaultMessage:"Cancel changes"}))),Object(f.jsx)(m.EuiFlexItem,{grow:!1},Object(f.jsx)(m.EuiToolTip,{content:e&&c.i18n.translate("advancedSettings.form.saveButtonTooltipWithInvalidChanges",{defaultMessage:"Fix invalid settings before saving."})},Object(f.jsx)(m.EuiButton,{className:"mgtAdvancedSettingsForm__button",disabled:e,color:"success",fill:!0,size:"s",iconType:"check",onClick:this.saveAll,"aria-describedby":"aria-describedby.countOfUnsavedSettings",isLoading:this.state.loading,"data-test-subj":"advancedSetting-saveButton"},c.i18n.translate("advancedSettings.form.saveButtonLabel",{defaultMessage:"Save changes"}))))))}))}setLoading(e){this.setState({loading:e})}renderClearQueryLink(e,t){const{clearQuery:n}=this.props;return e!==t?Object(f.jsx)(m.EuiFlexItem,{grow:!1},Object(f.jsx)("em",null,Object(f.jsx)(d.FormattedMessage,{id:"advancedSettings.form.searchResultText",defaultMessage:"Search terms are hiding {settingsCount} settings {clearSearch}",values:{settingsCount:e-t,clearSearch:Object(f.jsx)(m.EuiLink,{onClick:n},Object(f.jsx)("em",null,Object(f.jsx)(d.FormattedMessage,{id:"advancedSettings.form.clearSearchResultText",defaultMessage:"(clear search)"})))}}))):null}renderCategory(e,t,n){return Object(f.jsx)(s.Fragment,{key:e},Object(f.jsx)(m.EuiSplitPanel.Outer,{hasBorder:!0},Object(f.jsx)(m.EuiSplitPanel.Inner,{color:"subdued"},Object(f.jsx)(m.EuiFlexGroup,{alignItems:"baseline"},Object(f.jsx)(m.EuiFlexItem,{grow:!1},Object(f.jsx)(m.EuiTitle,null,Object(f.jsx)("h2",null,Object(j.d)(e)))),this.renderClearQueryLink(n,t.length))),Object(f.jsx)(m.EuiSplitPanel.Inner,null,t.map((e=>Object(f.jsx)(x.Field,{key:e.name,setting:e,handleChange:this.handleChange,unsavedChanges:this.state.unsavedChanges[e.name],clearChange:this.clearChange,enableSaving:this.props.enableSaving,dockLinks:this.props.dockLinks,toasts:this.props.toasts}))))),Object(f.jsx)(m.EuiSpacer,{size:"l"}))}maybeRenderNoSettings(e){return this.props.showNoResultsMessage?Object(f.jsx)(m.EuiCallOut,{color:"danger",title:Object(f.jsx)(a.a.Fragment,null,Object(f.jsx)(d.FormattedMessage,{id:"advancedSettings.form.noSearchResultText",defaultMessage:"No settings found for {queryText} {clearSearch}",values:{clearSearch:Object(f.jsx)(m.EuiLink,{onClick:e},Object(f.jsx)(d.FormattedMessage,{id:"advancedSettings.form.clearNoSearchResultText",defaultMessage:"(clear search)"})),queryText:Object(f.jsx)("strong",null,this.props.queryText)}}))}):null}render(){const{unsavedChanges:e}=this.state,{visibleSettings:t,categories:n,categoryCounts:a,clearQuery:i}=this.props,r=[],o=!Object(y.isEmpty)(e);return o?document.body.classList.add("kbnBody--mgtAdvancedSettingsHasBottomBar"):document.body.classList.remove("kbnBody--mgtAdvancedSettingsHasBottomBar"),n.forEach((e=>{t[e]&&t[e].length&&r.push(e)})),Object(f.jsx)(s.Fragment,null,Object(f.jsx)("div",null,r.length?r.map((e=>this.renderCategory(e,t[e],a[e]))):this.maybeRenderNoSettings(i)),o&&this.renderBottomBar())}}class advanced_settings_voice_announcement_AdvancedSettingsVoiceAnnouncement extends s.Component{constructor(...e){super(...e),h()(this,"shouldComponentUpdate",(e=>e.queryText!==this.props.queryText))}render(){const e=Object.values(this.props.settings).map((e=>e.map((e=>e.ariaName)))),t=[...e];return Object(f.jsx)(m.EuiScreenReaderOnly,null,Object(f.jsx)("div",{role:"region","aria-live":"polite","aria-label":c.i18n.translate("advancedSettings.voiceAnnouncement.ariaLabel",{defaultMessage:"Advanced Settings results info"})},Object(f.jsx)(m.EuiDelayRender,null,this.props.queryText?Object(f.jsx)(d.FormattedMessage,{id:"advancedSettings.voiceAnnouncement.searchResultScreenReaderMessage",defaultMessage:"You searched for {query}. There {optionLenght, plural, one {is # option} other {are # options}} in {sectionLenght, plural, one {# section} other {# sections}}",values:{query:this.props.queryText,sectionLenght:e.length,optionLenght:t.length}}):Object(f.jsx)(d.FormattedMessage,{id:"advancedSettings.voiceAnnouncement.noSearchResultScreenReaderMessage",defaultMessage:"There {optionLenght, plural, one {is # option} other {are # options}} in {sectionLenght, plural, one {# section} other {# sections}}",values:{sectionLenght:e.length,optionLenght:t.length}}))))}}const S="query";class advanced_settings_AdvancedSettings extends s.Component{constructor(e){super(e),h()(this,"settings",void 0),h()(this,"groupedSettings",void 0),h()(this,"categoryCounts",void 0),h()(this,"categories",[]),h()(this,"uiSettingsSubscription",void 0),h()(this,"unregister",void 0),h()(this,"initSettings",this.mapConfig),h()(this,"initGroupedSettings",this.mapSettings),h()(this,"onQueryChange",(({query:e})=>{this.setUrlQuery(e.text)})),h()(this,"clearQuery",(()=>{this.setUrlQuery("")})),h()(this,"onFooterQueryMatchChange",(e=>{this.setState({footerQueryMatched:e})})),h()(this,"saveConfig",(async e=>{const t=Object.entries(e).map((([e,t])=>this.props.uiSettings.set(e,t)));return Promise.all(t)})),this.settings=this.initSettings(this.props.uiSettings),this.groupedSettings=this.initGroupedSettings(this.settings),this.categories=this.initCategories(this.groupedSettings),this.categoryCounts=this.initCategoryCounts(this.groupedSettings),this.state=this.getQueryState(void 0,!0),this.unregister=this.props.history.listen((({search:e})=>{this.setState(this.getQueryState(e))}))}init(e){this.settings=this.initSettings(e),this.groupedSettings=this.initGroupedSettings(this.settings),this.categories=this.initCategories(this.groupedSettings),this.categoryCounts=this.initCategoryCounts(this.groupedSettings)}initCategories(e){return Object.keys(e).sort(((e,t)=>e===j.a?-1:t===j.a||e>t?1:e===t?0:-1))}initCategoryCounts(e){return Object.keys(e).reduce(((t,n)=>(t[n]=e[n].length,t)),{})}componentDidMount(){this.uiSettingsSubscription=this.props.uiSettings.getUpdate$().subscribe((()=>{const{query:e}=this.state;this.init(this.props.uiSettings),this.setState({filteredSettings:this.mapSettings(m.Query.execute(e,this.settings))})}));const{hash:e}=window.location;""!==e&&setTimeout((()=>{var t;const n=e.replace("#",""),s=document.getElementById(n);let a=0;const i=null===(t=document.getElementById("globalHeaderBars"))||void 0===t?void 0:t.getElementsByClassName("euiHeader");i&&Array.from(i).forEach((e=>{a+=e.offsetHeight})),s&&(s.scrollIntoView(),window.scrollBy(0,-a))}),0)}componentWillUnmount(){var e,t,n;null===(e=this.uiSettingsSubscription)||void 0===e||null===(t=e.unsubscribe)||void 0===t||t.call(e),null===(n=this.unregister)||void 0===n||n.call(this)}getQuery(e,t=!1){try{const n=t?Object(j.c)(e):null!=e?e:"";return m.Query.parse(n)}catch({message:e}){return this.props.toasts.addWarning({title:b.c,text:e}),m.Query.parse("")}}getQueryText(e){var t,n;return null!==(n=(null!==(t=Object(p.parse)(null!=e?e:window.location.search))&&void 0!==t?t:{}).query)&&void 0!==n?n:""}getQueryState(e,t=!1){const n=this.getQueryText(e),s=this.getQuery(n,t),a=this.mapSettings(m.Query.execute(s,this.settings));return{query:s,filteredSettings:a,footerQueryMatched:Object.keys(a).length>0}}setUrlQuery(e=""){const t=l.url.addQueryParam(window.location.search,S,e);this.props.history.push({pathname:"",search:t})}mapConfig(e){const t=e.getAll();return Object.entries(t).map((([t,n])=>Object(j.f)({def:n,name:t,value:n.userValue,isCustom:e.isCustom(t),isOverridden:e.isOverridden(t)}))).filter((e=>!e.readOnly)).sort(j.b)}mapSettings(e){return e.reduce(((e,t)=>{const n=t.category[0];return(e[n]=e[n]||[]).push(t),e}),{})}render(){const{filteredSettings:e,query:t,footerQueryMatched:n}=this.state,s=this.props.componentRegistry,a=s.get(s.componentType.PAGE_TITLE_COMPONENT),i=s.get(s.componentType.PAGE_SUBTITLE_COMPONENT),r=s.get(s.componentType.PAGE_FOOTER_COMPONENT);return Object(f.jsx)("div",null,Object(f.jsx)(m.EuiFlexGroup,{gutterSize:"none"},Object(f.jsx)(m.EuiFlexItem,null,Object(f.jsx)(a,null)),Object(f.jsx)(m.EuiFlexItem,null,Object(f.jsx)(b.b,{query:t,categories:this.categories,onQueryChange:this.onQueryChange}))),Object(f.jsx)(i,null),Object(f.jsx)(m.EuiSpacer,{size:"m"}),Object(f.jsx)(v,null),Object(f.jsx)(m.EuiSpacer,{size:"m"}),Object(f.jsx)(advanced_settings_voice_announcement_AdvancedSettingsVoiceAnnouncement,{queryText:t.text,settings:e}),Object(f.jsx)(u.KibanaContextProvider,{services:{uiSettings:this.props.uiSettings}},Object(f.jsx)(form_Form,{settings:this.groupedSettings,visibleSettings:e,categories:this.categories,categoryCounts:this.categoryCounts,clearQuery:this.clearQuery,save:this.saveConfig,showNoResultsMessage:!n,enableSaving:this.props.enableSaving,dockLinks:this.props.dockLinks,toasts:this.props.toasts,trackUiMetric:this.props.trackUiMetric,queryText:t.text,theme:this.props.theme})),Object(f.jsx)(r,{toasts:this.props.toasts,query:t,onQueryMatchChange:this.onFooterQueryMatchChange,enableSaving:this.props.enableSaving}))}}n(27);const O=c.i18n.translate("advancedSettings.advancedSettingsLabel",{defaultMessage:"Advanced Settings"}),C=[{text:O}],_={text:c.i18n.translate("advancedSettings.badge.readOnly.text",{defaultMessage:"Read only"}),tooltip:c.i18n.translate("advancedSettings.badge.readOnly.tooltip",{defaultMessage:"Unable to save advanced settings"}),iconType:"glasses"},E=({match:e,location:t})=>({pathname:"/",search:l.url.addQueryParam(t.search,S,null==e?void 0:e.params.query)});async function w(e,t,n,s){t.setBreadcrumbs(C);const[{uiSettings:a,notifications:i,docLinks:c,application:l,chrome:g}]=await e(),h=l.capabilities.advancedSettings.save,p=null==s?void 0:s.reportUiCounter.bind(s,"advanced_settings");return h||g.setBadge(_),g.docTitle.change(O),r.a.render(Object(f.jsx)(u.KibanaThemeProvider,{theme$:t.theme$},Object(f.jsx)(d.I18nProvider,null,Object(f.jsx)(o.Router,{history:t.history},Object(f.jsx)(o.Switch,null,Object(f.jsx)(o.Route,{path:"/:query"},(e=>Object(f.jsx)(o.Redirect,{to:E(e)}))),Object(f.jsx)(o.Route,{path:"/"},Object(f.jsx)(advanced_settings_AdvancedSettings,{history:t.history,enableSaving:h,toasts:i.toasts,dockLinks:c.links,uiSettings:a,theme:t.theme$,componentRegistry:n,trackUiMetric:p})))))),t.element),()=>{g.docTitle.reset(),r.a.unmountComponentAtNode(t.element)}}}}]);