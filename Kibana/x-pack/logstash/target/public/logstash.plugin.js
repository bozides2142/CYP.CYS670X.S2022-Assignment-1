/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(e){function t(t){for(var i,s,r=t[0],a=t[1],o=0,c=[];o<r.length;o++)s=r[o],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&c.push(n[s][0]),n[s]=0;for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i]);for(l&&l(t);c.length;)c.shift()()}var i={},n={0:0};function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],i=n[e];if(0!==i)if(i)t.push(i[2]);else{var r=new Promise((function(t,s){i=n[e]=[t,s]}));t.push(i[2]=r);var a,o=document.createElement("script");o.charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.src=function(e){return s.p+"logstash.chunk."+e+".js"}(e);var l=new Error;a=function(t){o.onerror=o.onload=null,clearTimeout(c);var i=n[e];if(0!==i){if(i){var s=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+s+": "+r+")",l.name="ChunkLoadError",l.type=s,l.request=r,i[1](l)}n[e]=void 0}};var c=setTimeout((function(){a({type:"timeout",target:o})}),12e4);o.onerror=o.onload=a,document.head.appendChild(o)}return Promise.all(t)},s.m=e,s.c=i,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var r=window.logstash_bundle_jsonpfunction=window.logstash_bundle_jsonpfunction||[],a=r.push.bind(r);r.push=t,r=r.slice();for(var o=0;o<r.length;o++)t(r[o]);var l=a;s(s.s=10)}([function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t,i){e.exports=i(12)(2)},function(e,t){e.exports=__kbnSharedDeps__.Moment},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(1);const s={settings:{"pipeline.workers":n.i18n.translate("xpack.logstash.workersTooltip",{defaultMessage:"The number of workers that will, in parallel, execute the filter and output stages of the pipeline. If you find that events are backing up, or that the CPU is not saturated, consider increasing this number to better utilize machine processing power.\n\nDefault value: Number of the hostâ€™s CPU cores"}),"pipeline.batch.size":n.i18n.translate("xpack.logstash.pipelineBatchSizeTooltip",{defaultMessage:"The maximum number of events an individual worker thread will collect from inputs before attempting to execute its filters and outputs. Larger batch sizes are generally more efficient, but come at the cost of increased memory overhead. You may have to increase the JVM heap size by setting the LS_HEAP_SIZE variable to effectively use the option.\n\nDefault value: 125"}),"pipeline.batch.delay":n.i18n.translate("xpack.logstash.pipelineBatchDelayTooltip",{defaultMessage:"When creating pipeline event batches, how long in milliseconds to wait for each event before dispatching an undersized batch to pipeline workers.\n\nDefault value: 50ms"}),"queue.type":n.i18n.translate("xpack.logstash.queueTypeTooltip",{defaultMessage:"The internal queuing model to use for event buffering. Specify memory for legacy in-memory based queuing, or persisted for disk-based ACKed queueing\n\nDefault value: memory"}),"queue.max_bytes":n.i18n.translate("xpack.logstash.queueMaxBytesTooltip",{defaultMessage:"The total capacity of the queue in number of bytes. Make sure the capacity of your disk drive is greater than the value you specify here.\n\nDefault value: 1024mb (1g)"}),"queue.checkpoint.writes":n.i18n.translate("xpack.logstash.queueCheckpointWritesTooltip",{defaultMessage:"The maximum number of written events before forcing a checkpoint when persistent queues are enabled. Specify 0 to set this value to unlimited.\n\nDefault value: 1024"})}}},function(e,t){e.exports=__kbnSharedDeps__.RxjsOperators},function(e,t,i){"use strict";i.d(t,"a",(function(){return cluster_service_ClusterService})),i.d(t,"b",(function(){return logstash_license_service_LogstashLicenseService})),i.d(t,"c",(function(){return monitoring_service_MonitoringService})),i.d(t,"d",(function(){return pipeline_service_PipelineService})),i.d(t,"e",(function(){return pipelines_service_PipelinesService}));const n="/api/logstash",s="/api/monitoring";i(5);const r={CCM:"centralized_configuration_management",OTHER:"file_or_command_line_interface_or_pipelines_yml"},a=30;var o=i(0);class cluster_Cluster{constructor(e){this.uuid=Object(o.get)(e,"uuid")}static fromUpstreamJSON(e){return new cluster_Cluster({uuid:e.uuid})}}class cluster_service_ClusterService{constructor(e){this.http=e}loadCluster(){return this.http.get(`${n}/cluster`).then((e=>{if(e)return cluster_Cluster.fromUpstreamJSON(e.cluster)}))}isClusterInfoAvailable(){return this.loadCluster().then((e=>Boolean(e))).catch((()=>!1))}}var l=i(1);class logstash_license_service_LogstashLicenseService{constructor(e,t,i){this.license=e,this.navigateToApp=t,this.toasts=i}get enableLinks(){return this.calculated.enableLinks}get isAvailable(){return this.calculated.isAvailable}get isReadOnly(){return this.calculated.isReadOnly}get message(){return this.calculated.message}get isSecurityEnabled(){return this.license.getFeature("security").isEnabled}checkValidity(){return new Promise(((e,t)=>this.isAvailable?e():t()))}get calculated(){if(!this.license)throw new Error("No license available!");return this.isSecurityEnabled?this.license.hasAtLeast("standard")?this.license.isActive?{isAvailable:!0,enableLinks:!0,isReadOnly:!1}:{isAvailable:!0,enableLinks:!0,isReadonly:!0,message:l.i18n.translate("xpack.logstash.managementSection.pipelineCrudOperationsNotAllowedDescription",{defaultMessage:"You cannot edit, create, or delete your Logstash pipelines because your {licenseType} license has expired.",values:{licenseType:this.license.type}})}:{isAvailable:!1,enableLinks:!1,isReadOnly:!1,message:l.i18n.translate("xpack.logstash.managementSection.licenseDoesNotSupportDescription",{defaultMessage:"Your {licenseType} license does not support Logstash pipeline management features. Please upgrade your license.",values:{licenseType:this.license.type}})}:{isAvailable:!1,enableLinks:!1,isReadOnly:!1,message:l.i18n.translate("xpack.logstash.managementSection.enableSecurityDescription",{defaultMessage:"Security must be enabled in order to use Logstash pipeline management features. Please set xpack.security.enabled: true in your elasticsearch.yml."})}}}var c=i(3),u=i.n(c);class pipeline_list_item_PipelineListItem{constructor(e){this.id=e.id,this.origin=e.origin,this.description=e.description,this.username=e.username,e.lastModified&&(this.lastModified=function(e){if(!e)return null;return u()(e)}(e.lastModified),this.lastModifiedHumanized=Object(o.upperFirst)(this.lastModified.fromNow()))}get searchValue(){return e=this,t=["id"],Object(o.values)(Object(o.pick)(e,t)).join("\n");var e,t}get isCentrallyManaged(){return this.origin===r.CCM}static fromUpstreamJSON(e){const t=Object(o.pick)(e,["id","description","username"]);return t.origin=r.CCM,t.lastModified=e.last_modified,new pipeline_list_item_PipelineListItem(t)}static fromUpstreamMonitoringJSON(e){const t=Object(o.pick)(e,["id"]);return t.origin=r.OTHER,new pipeline_list_item_PipelineListItem(t)}}class monitoring_service_MonitoringService{constructor(e,t,i){this.http=e,this._isMonitoringEnabled=t,this.clusterService=i}isMonitoringEnabled(){return this._isMonitoringEnabled}getPipelineList(){return this.isMonitoringEnabled()?this.clusterService.loadCluster().then((e=>{const t=`${s}/v1/clusters/${e.uuid}/logstash/pipeline_ids`,i=u.a.utc(),n=JSON.stringify({timeRange:{max:i.toISOString(),min:i.subtract(a,"seconds").toISOString()}});return this.http.post(t,{body:n})})).then((e=>e.map((e=>pipeline_list_item_PipelineListItem.fromUpstreamMonitoringJSON(e))))).catch((()=>[])):Promise.resolve([])}}var p=i(8);class pipeline_service_PipelineService{constructor(e,t){this.http=e,this.pipelinesService=t}loadPipeline(e){return this.http.get(`${n}/pipeline/${e}`).then((e=>p.a.fromUpstreamJSON(e)))}savePipeline(e){return this.http.put(`${n}/pipeline/${e.id}`,{body:JSON.stringify(e.upstreamJSON)}).catch((e=>{throw e.message}))}deletePipeline(e){return this.http.delete(`${n}/pipeline/${e}`).then((()=>this.pipelinesService.addToRecentlyDeleted(e))).catch((e=>{throw e.message}))}}const d="xpack.logstash.recentlyDeletedPipelines";class pipelines_service_PipelinesService{constructor(e,t){this.http=e,this.monitoringService=t}getPipelineList(){return Promise.all([this.getManagementPipelineList(),this.getMonitoringPipelineList()]).then((([e,t])=>{const i=Date.now(),n=t.map((e=>e.id));this.getRecentlyDeleted().forEach((e=>{i-e.deletedOn<1e3*a||n.includes(e.id)||this.removeFromRecentlyDeleted(e.id)}));const s=e.map((e=>e.id));return e.concat(t.filter((e=>!s.includes(e.id)&&!this.isRecentlyDeleted(e.id))))}))}getManagementPipelineList(){return this.http.get(`${n}/pipelines`).then((e=>e.pipelines.map((e=>pipeline_list_item_PipelineListItem.fromUpstreamJSON(e)))))}getMonitoringPipelineList(){return this.monitoringService.getPipelineList()}deletePipelines(e){const t=JSON.stringify({pipelineIds:e});return this.http.post(`${n}/pipelines/delete`,{body:t}).then((t=>(this.addToRecentlyDeleted(...e),t.results)))}addToRecentlyDeleted(...e){const t=this.getRecentlyDeleted(),i=t.map((e=>e.id));e.forEach((e=>{i.includes(e)||t.push({id:e,deletedOn:Date.now()})})),this.setRecentlyDeleted(t)}removeFromRecentlyDeleted(...e){const t=this.getRecentlyDeleted().filter((t=>!e.includes(t.id)));this.setRecentlyDeleted(t)}isRecentlyDeleted(e){return this.getRecentlyDeleted().map((e=>e.id)).includes(e)}getRecentlyDeleted(){const e=window.localStorage.getItem(d);return e?JSON.parse(e):[]}setRecentlyDeleted(e){window.localStorage.setItem(d,JSON.stringify(e))}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return pipeline_Pipeline}));var n=i(2),s=i.n(n),r=i(0);const a={"pipeline.workers":null,"pipeline.batch.size":125,"pipeline.batch.delay":50,"queue.type":"memory","queue.max_bytes.number":1,"queue.max_bytes.units":"gb","queue.checkpoint.writes":1024};class pipeline_Pipeline{constructor(e){s()(this,"isEqualTo",(e=>{const t={...this},i={...e};return Object(r.isEqual)(t,i)})),this.id=Object(r.get)(e,"id"),this.description=Object(r.get)(e,"description",""),this.pipeline=Object(r.get)(e,"pipeline","input {\n}\nfilter {\n}\noutput {\n}"),this.username=Object(r.get)(e,"username"),this.settings=Object(r.defaultsDeep)(Object(r.get)(e,"settings",{}),a)}get clone(){return new pipeline_Pipeline({...Object(r.omit)(this,["id","username"])})}get upstreamJSON(){const e=this.settings,t=Object(r.get)(e,"queue.max_bytes.number"),i=Object(r.get)(e,"queue.max_bytes.units"),n={...e};return t&&i&&(delete n["queue.max_bytes.number"],delete n["queue.max_bytes.units"],n["queue.max_bytes"]=`${t}${i}`),{description:this.description,pipeline:this.pipeline,username:this.username,settings:n}}static fromUpstreamJSON(e){const t=e.settings,i=Object(r.get)(t,"queue.max_bytes","").match(/(\d+)(\w+)/);if(Array.isArray(i)&&3===i.length){const e=i[1],n=i[2];e&&n&&(delete t["queue.max_bytes"],t["queue.max_bytes.number"]=parseInt(e),t["queue.max_bytes.units"]=n)}return new pipeline_Pipeline({id:e.id,description:e.description,pipeline:e.pipeline,username:e.username,settings:t})}}},function(e,t,i){i.r(t);var n=__kbnBundles__.get("plugin/home/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t,i){i(11),__kbnBundles__.define("plugin/logstash/public",i,13)},function(e,t,i){i.p=window.__kbnPublicPath__.logstash},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,i){"use strict";i.r(t),i.d(t,"plugin",(function(){return p}));var n=i(2),s=i.n(n),r=i(1),a=i(4),o=i(6),l=i(0),c=i(9),u=i(7);class plugin_LogstashPlugin{constructor(){s()(this,"licenseSubscription",void 0),s()(this,"capabilities$",new a.Subject)}setup(e,t){const n=t.licensing.license$.pipe(Object(o.map)((e=>new u.b(e)))),s=t.management.sections.section.ingest.registerApp({id:"pipelines",title:r.i18n.translate("xpack.logstash.managementSection.pipelinesTitle",{defaultMessage:"Logstash Pipelines"}),order:1,mount:async s=>{const[r]=await e.getStartServices(),{renderApp:a}=await i.e(1).then(i.bind(null,27));return a(r,s,"monitoring"in t,n)}});this.licenseSubscription=Object(a.combineLatest)([n,this.capabilities$]).subscribe((([e,i])=>{const n=e.enableLinks&&!0===i.management.ingest.pipelines;n?s.enable():s.disable(),t.home&&n&&Object(l.once)((()=>{t.home.featureCatalogue.register({id:"management_logstash",title:r.i18n.translate("xpack.logstash.homeFeature.logstashPipelinesTitle",{defaultMessage:"Logstash Pipelines"}),description:r.i18n.translate("xpack.logstash.homeFeature.logstashPipelinesDescription",{defaultMessage:"Create, delete, update, and clone data ingestion pipelines."}),icon:"pipelineApp",path:"/app/management/ingest/pipelines",showOnHomePage:!1,category:c.FeatureCatalogueCategory.ADMIN})}))}))}start(e){this.capabilities$.next(e.application.capabilities)}stop(){this.licenseSubscription&&this.licenseSubscription.unsubscribe()}}const p=()=>new plugin_LogstashPlugin},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t){e.exports=__kbnSharedDeps__.ReactDom},function(e,t){e.exports=__kbnSharedDeps__.ReactRouterDom},function(e,t,i){i.r(t);var n=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t,i){i.r(t);var n=__kbnBundles__.get("plugin/esUiShared/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t){e.exports=__kbnSharedDeps__.TsLib}]);